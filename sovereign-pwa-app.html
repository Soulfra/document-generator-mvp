<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#000000">
    <link rel="manifest" href="/manifest.json">
    <title>Sovereign Gateway - Pure Signal Interface</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #00ff00;
            --secondary: #ff00ff;
            --tertiary: #00ffff;
            --background: #0a0a0a;
            --surface: #1a1a1a;
            --text: #ffffff;
            --rainbow-1: #ff0000;
            --rainbow-2: #ff7f00;
            --rainbow-3: #ffff00;
            --rainbow-4: #00ff00;
            --rainbow-5: #0000ff;
            --rainbow-6: #4b0082;
            --rainbow-7: #9400d3;
        }

        body {
            background: var(--background);
            color: var(--text);
            font-family: 'Courier New', monospace;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow-x: hidden;
        }

        /* Rainbow road background */
        .rainbow-road {
            position: fixed;
            top: 0;
            left: -100%;
            width: 300%;
            height: 100%;
            background: linear-gradient(
                90deg,
                var(--rainbow-1) 0%,
                var(--rainbow-2) 14%,
                var(--rainbow-3) 28%,
                var(--rainbow-4) 42%,
                var(--rainbow-5) 56%,
                var(--rainbow-6) 70%,
                var(--rainbow-7) 84%,
                var(--rainbow-1) 100%
            );
            opacity: 0.1;
            animation: rainbow-flow 20s linear infinite;
            z-index: -1;
        }

        @keyframes rainbow-flow {
            0% { transform: translateX(0); }
            100% { transform: translateX(33.33%); }
        }

        /* Header */
        .header {
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-bottom: 2px solid var(--primary);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header h1 {
            font-size: 24px;
            text-align: center;
            background: linear-gradient(45deg, var(--primary), var(--secondary), var(--tertiary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradient-shift 3s ease-in-out infinite;
        }

        @keyframes gradient-shift {
            0%, 100% { filter: hue-rotate(0deg); }
            50% { filter: hue-rotate(180deg); }
        }

        .sovereignty-status {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-top: 10px;
            font-size: 12px;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--primary);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
        }

        /* Main interface */
        .main-container {
            flex: 1;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }

        /* Query input */
        .query-section {
            background: var(--surface);
            border: 1px solid var(--primary);
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .query-section::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, var(--primary), var(--secondary), var(--tertiary));
            border-radius: 10px;
            opacity: 0.3;
            z-index: -1;
            animation: border-glow 3s ease-in-out infinite;
        }

        @keyframes border-glow {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.6; }
        }

        .query-input {
            width: 100%;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #333;
            border-radius: 5px;
            padding: 15px;
            color: var(--text);
            font-size: 16px;
            font-family: inherit;
            transition: all 0.3s;
        }

        .query-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
        }

        .query-controls {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .btn {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            color: #000;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 255, 0, 0.5);
        }

        /* Route visualization */
        .route-visualization {
            background: var(--surface);
            border: 1px solid #333;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            min-height: 200px;
            position: relative;
            overflow: hidden;
        }

        .route-path {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 20px 0;
            position: relative;
        }

        .route-node {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            position: relative;
            z-index: 2;
            cursor: pointer;
            transition: all 0.3s;
        }

        .route-node:hover {
            transform: scale(1.2);
        }

        .route-node.rainbow { background: linear-gradient(45deg, var(--rainbow-1), var(--rainbow-7)); }
        .route-node.onion { background: #8B4513; }
        .route-node.filter { background: #FF0000; }
        .route-node.reasoning { background: #FFD700; }
        .route-node.truth { background: #00CED1; }
        .route-node.testing { background: #FF69B4; }
        .route-node.vault { background: #9400D3; }
        .route-node.output { background: #00FF00; }

        .route-connection {
            position: absolute;
            top: 50%;
            left: 60px;
            right: 60px;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--primary), transparent);
            transform: translateY(-50%);
            z-index: 1;
        }

        .route-connection.active {
            animation: data-flow 2s linear infinite;
        }

        @keyframes data-flow {
            0% { background-position: -100% 0; }
            100% { background-position: 100% 0; }
        }

        /* A/B/C/D Testing */
        .testing-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .variant-card {
            background: var(--surface);
            border: 1px solid #333;
            border-radius: 10px;
            padding: 20px;
            position: relative;
            transition: all 0.3s;
            cursor: pointer;
        }

        .variant-card:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 255, 0, 0.2);
        }

        .variant-card.selected {
            border-color: var(--secondary);
            background: rgba(255, 0, 255, 0.1);
        }

        .variant-card.pinned {
            border-color: var(--tertiary);
            background: rgba(0, 255, 255, 0.1);
        }

        .variant-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .variant-label {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary);
        }

        .pin-btn {
            background: none;
            border: 1px solid #666;
            color: #666;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .pin-btn:hover {
            border-color: var(--tertiary);
            color: var(--tertiary);
        }

        .pin-btn.pinned {
            background: var(--tertiary);
            color: #000;
        }

        /* Results display */
        .results-section {
            background: var(--surface);
            border: 1px solid #333;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .purity-meter {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .purity-bar {
            width: 200px;
            height: 20px;
            background: #333;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .purity-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff0000, #ffff00, #00ff00);
            transition: width 1s ease;
        }

        .truth-score {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary);
        }

        /* Notification system */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--surface);
            border: 1px solid var(--primary);
            border-radius: 10px;
            padding: 20px;
            max-width: 300px;
            transform: translateX(400px);
            transition: transform 0.3s;
            z-index: 2000;
        }

        .notification.show {
            transform: translateX(0);
        }

        /* Sovereign controls */
        .sovereign-controls {
            position: fixed;
            bottom: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .sovereign-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--surface);
            border: 2px solid var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .sovereign-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.5);
        }

        /* Mobile responsiveness */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 18px;
            }
            
            .sovereignty-status {
                flex-direction: column;
                gap: 5px;
            }
            
            .testing-grid {
                grid-template-columns: 1fr;
            }
            
            .route-path {
                flex-wrap: wrap;
            }
        }

        /* Loading animation */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .loading-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .loading-spinner {
            width: 100px;
            height: 100px;
            border: 3px solid transparent;
            border-top-color: var(--primary);
            border-right-color: var(--secondary);
            border-bottom-color: var(--tertiary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Vibe indicator */
        .vibe-indicator {
            position: fixed;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            width: 60px;
            height: 300px;
            background: var(--surface);
            border: 1px solid #333;
            border-radius: 30px;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
        }

        .vibe-level {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #333;
            transition: all 0.3s;
            cursor: pointer;
        }

        .vibe-level.active {
            background: var(--primary);
            box-shadow: 0 0 20px currentColor;
        }
    </style>
</head>
<body>
    <div class="rainbow-road"></div>
    
    <header class="header">
        <h1>SOVEREIGN GATEWAY</h1>
        <div class="sovereignty-status">
            <div class="status-indicator">
                <span class="status-dot"></span>
                <span>Unfuckwithable: ACTIVE</span>
            </div>
            <div class="status-indicator">
                <span class="status-dot" style="background: #ff00ff"></span>
                <span>Signal: PURE</span>
            </div>
            <div class="status-indicator">
                <span class="status-dot" style="background: #00ffff"></span>
                <span>Noise: ELIMINATED</span>
            </div>
        </div>
    </header>

    <main class="main-container">
        <!-- Query Section -->
        <section class="query-section">
            <h2>Talk to Our Guy</h2>
            <p style="margin: 10px 0; opacity: 0.7;">He'll take the rainbow road through the onion layers and bring back pure signal</p>
            
            <textarea class="query-input" 
                      placeholder="What truth do you seek? (No bullshit will make it through)"
                      rows="4"></textarea>
            
            <div class="query-controls">
                <button class="btn" onclick="processQuery()">
                    <span>SEEK TRUTH</span>
                </button>
                <button class="btn" onclick="activateRainbowMode()">
                    <span>🌈 RAINBOW MODE</span>
                </button>
                <button class="btn" onclick="deepDive()">
                    <span>🧅 DEEP DIVE</span>
                </button>
                <button class="btn" onclick="maxProtection()">
                    <span>🛡️ MAX PROTECTION</span>
                </button>
            </div>
        </section>

        <!-- Route Visualization -->
        <section class="route-visualization">
            <h3>Signal Path</h3>
            <div class="route-path">
                <div class="route-node rainbow" title="Rainbow Router">🌈</div>
                <div class="route-connection"></div>
                <div class="route-node onion" title="Onion Layers">🧅</div>
                <div class="route-connection"></div>
                <div class="route-node filter" title="Bullshit Filter">🚫</div>
                <div class="route-connection"></div>
                <div class="route-node reasoning" title="ARD System">🧠</div>
                <div class="route-connection"></div>
                <div class="route-node truth" title="Truth Detection">📡</div>
                <div class="route-connection"></div>
                <div class="route-node testing" title="A/B/C/D Testing">🧪</div>
                <div class="route-connection"></div>
                <div class="route-node vault" title="Vibecoding Vault">🔐</div>
                <div class="route-connection"></div>
                <div class="route-node output" title="Pure Signal">✨</div>
            </div>
        </section>

        <!-- A/B/C/D Testing Grid -->
        <section class="testing-section" style="display: none;">
            <h3>Live A/B/C/D Testing</h3>
            <div class="testing-grid">
                <div class="variant-card" data-variant="A">
                    <div class="variant-header">
                        <span class="variant-label">A</span>
                        <button class="pin-btn" onclick="togglePin('A')">📌</button>
                    </div>
                    <div class="variant-content">
                        <p>Original Signal</p>
                        <div class="variant-result"></div>
                    </div>
                </div>
                
                <div class="variant-card" data-variant="B">
                    <div class="variant-header">
                        <span class="variant-label">B</span>
                        <button class="pin-btn" onclick="togglePin('B')">📌</button>
                    </div>
                    <div class="variant-content">
                        <p>Speed Optimized</p>
                        <div class="variant-result"></div>
                    </div>
                </div>
                
                <div class="variant-card" data-variant="C">
                    <div class="variant-header">
                        <span class="variant-label">C</span>
                        <button class="pin-btn" onclick="togglePin('C')">📌</button>
                    </div>
                    <div class="variant-content">
                        <p>Accuracy Focused</p>
                        <div class="variant-result"></div>
                    </div>
                </div>
                
                <div class="variant-card" data-variant="D">
                    <div class="variant-header">
                        <span class="variant-label">D</span>
                        <button class="pin-btn" onclick="togglePin('D')">📌</button>
                    </div>
                    <div class="variant-content">
                        <p>Comprehension Enhanced</p>
                        <div class="variant-result"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Results Section -->
        <section class="results-section" style="display: none;">
            <div class="result-header">
                <h3>Pure Signal Detected</h3>
                <div class="purity-meter">
                    <span>Purity:</span>
                    <div class="purity-bar">
                        <div class="purity-fill" style="width: 0%"></div>
                    </div>
                    <span class="truth-score">0%</span>
                </div>
            </div>
            <div class="result-content"></div>
        </section>
    </main>

    <!-- Sovereign Controls -->
    <div class="sovereign-controls">
        <button class="sovereign-btn" onclick="openVault()" title="Vibecoding Vault">
            🔐
        </button>
        <button class="sovereign-btn" onclick="toggleNotifications()" title="Notifications">
            🔔
        </button>
        <button class="sovereign-btn" onclick="showStats()" title="Statistics">
            📊
        </button>
        <button class="sovereign-btn" onclick="emergencyMode()" title="Emergency Mode">
            🚨
        </button>
    </div>

    <!-- Vibe Indicator -->
    <div class="vibe-indicator">
        <div class="vibe-level" data-vibe="high" style="background: #00ff00"></div>
        <div class="vibe-level" data-vibe="medium" style="background: #ffff00"></div>
        <div class="vibe-level" data-vibe="low" style="background: #ff0000"></div>
        <div class="vibe-level" data-vibe="quantum" style="background: #ff00ff"></div>
        <div class="vibe-level" data-vibe="void" style="background: #000"></div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <h4>Signal Update</h4>
        <p id="notification-text"></p>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading">
        <div class="loading-spinner"></div>
    </div>

    <script>
        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js')
                .then(reg => console.log('Service Worker registered'))
                .catch(err => console.error('Service Worker registration failed:', err));
        }

        // WebSocket connection to backend
        let ws = null;
        let currentQuery = null;
        let pinnedVariants = new Set();

        function connectWebSocket() {
            ws = new WebSocket('ws://localhost:8082');
            
            ws.onopen = () => {
                console.log('Connected to Sovereign Gateway');
                showNotification('Connected to pure signal stream');
            };
            
            ws.onmessage = (event) => {
                const data = JSON.parse(event.data);
                handleServerMessage(data);
            };
            
            ws.onerror = (error) => {
                console.error('WebSocket error:', error);
                showNotification('Connection disrupted - entering offline mode');
            };
            
            ws.onclose = () => {
                console.log('Disconnected - attempting reconnect...');
                setTimeout(connectWebSocket, 3000);
            };
        }

        // Process query through sovereign gateway
        async function processQuery() {
            const input = document.querySelector('.query-input').value;
            if (!input.trim()) return;
            
            currentQuery = input;
            showLoading(true);
            
            // Animate route visualization
            animateRoute();
            
            // Send to backend
            if (ws && ws.readyState === WebSocket.OPEN) {
                ws.send(JSON.stringify({
                    type: 'query',
                    data: input,
                    sovereignty: getSovereigntyLevel(),
                    vibe: getCurrentVibe()
                }));
            } else {
                // Offline mode - use cached wisdom
                processOffline(input);
            }
        }

        // Animate the signal path
        function animateRoute() {
            const connections = document.querySelectorAll('.route-connection');
            const nodes = document.querySelectorAll('.route-node');
            
            connections.forEach((conn, index) => {
                setTimeout(() => {
                    conn.classList.add('active');
                    if (nodes[index + 1]) {
                        nodes[index + 1].style.transform = 'scale(1.2)';
                        setTimeout(() => {
                            nodes[index + 1].style.transform = 'scale(1)';
                        }, 300);
                    }
                }, index * 500);
            });
            
            // Reset after animation
            setTimeout(() => {
                connections.forEach(conn => conn.classList.remove('active'));
            }, connections.length * 500 + 1000);
        }

        // Handle server messages
        function handleServerMessage(data) {
            switch (data.type) {
                case 'route-update':
                    updateRouteVisualization(data);
                    break;
                case 'test-results':
                    displayTestResults(data);
                    break;
                case 'final-signal':
                    displayFinalSignal(data);
                    break;
                case 'notification':
                    showNotification(data.message);
                    break;
            }
        }

        // Display A/B/C/D test results
        function displayTestResults(data) {
            document.querySelector('.testing-section').style.display = 'block';
            
            data.variants.forEach(variant => {
                const card = document.querySelector(`[data-variant="${variant.id}"]`);
                const resultDiv = card.querySelector('.variant-result');
                
                resultDiv.innerHTML = `
                    <p>Score: ${variant.score}/100</p>
                    <p>Speed: ${variant.speed}ms</p>
                    <p>Accuracy: ${variant.accuracy}%</p>
                `;
                
                if (variant.winner) {
                    card.classList.add('selected');
                }
            });
        }

        // Display final pure signal
        function displayFinalSignal(data) {
            showLoading(false);
            
            const resultsSection = document.querySelector('.results-section');
            resultsSection.style.display = 'block';
            
            // Update purity meter
            const purityFill = document.querySelector('.purity-fill');
            const truthScore = document.querySelector('.truth-score');
            purityFill.style.width = `${data.purity}%`;
            truthScore.textContent = `${data.truthScore}%`;
            
            // Display content
            const resultContent = document.querySelector('.result-content');
            resultContent.innerHTML = `
                <div class="signal-content">
                    <h4>Pure Signal:</h4>
                    <p>${data.signal}</p>
                    
                    <h4>Eliminated Noise:</h4>
                    <ul>
                        ${data.filtered.map(item => `<li>${item}</li>`).join('')}
                    </ul>
                    
                    <h4>Truth Confidence:</h4>
                    <p>${data.confidence}% certain</p>
                    
                    <h4>Sovereignty Status:</h4>
                    <p>${data.sovereignty}</p>
                </div>
            `;
        }

        // Pin/unpin variants
        function togglePin(variant) {
            const btn = document.querySelector(`[data-variant="${variant}"] .pin-btn`);
            
            if (pinnedVariants.has(variant)) {
                pinnedVariants.delete(variant);
                btn.classList.remove('pinned');
                document.querySelector(`[data-variant="${variant}"]`).classList.remove('pinned');
            } else {
                pinnedVariants.add(variant);
                btn.classList.add('pinned');
                document.querySelector(`[data-variant="${variant}"]`).classList.add('pinned');
            }
            
            // Notify backend
            if (ws && ws.readyState === WebSocket.OPEN) {
                ws.send(JSON.stringify({
                    type: 'pin-variant',
                    variant: variant,
                    pinned: pinnedVariants.has(variant)
                }));
            }
        }

        // Get current sovereignty level
        function getSovereigntyLevel() {
            // This would check user credentials, NFTs, etc.
            return {
                level: 'sovereign',
                trust: 100,
                verified: true
            };
        }

        // Get current vibe
        function getCurrentVibe() {
            const activeVibe = document.querySelector('.vibe-level.active');
            return activeVibe ? activeVibe.dataset.vibe : 'medium';
        }

        // Show notification
        function showNotification(message) {
            const notification = document.getElementById('notification');
            const text = document.getElementById('notification-text');
            
            text.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Loading overlay
        function showLoading(show) {
            const loading = document.getElementById('loading');
            if (show) {
                loading.classList.add('active');
            } else {
                loading.classList.remove('active');
            }
        }

        // Special modes
        function activateRainbowMode() {
            document.body.style.animation = 'rainbow-background 5s linear infinite';
            showNotification('🌈 Rainbow Mode Activated - Maximum spectrum coverage');
        }

        function deepDive() {
            showNotification('🧅 Deep Dive Mode - Accessing interdimensional layers');
            // Trigger deep search
        }

        function maxProtection() {
            showNotification('🛡️ Maximum Protection - All countermeasures active');
            // Activate all protection layers
        }

        function emergencyMode() {
            if (confirm('Activate Emergency Mode? This will destroy all traces.')) {
                showNotification('🚨 Emergency Mode Activated');
                // Trigger emergency protocols
            }
        }

        // Vibe level selection
        document.querySelectorAll('.vibe-level').forEach(level => {
            level.addEventListener('click', () => {
                document.querySelectorAll('.vibe-level').forEach(l => l.classList.remove('active'));
                level.classList.add('active');
                showNotification(`Vibe set to: ${level.dataset.vibe}`);
            });
        });

        // Initialize
        connectWebSocket();
        
        // Set default vibe
        document.querySelector('[data-vibe="medium"]').classList.add('active');

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'Enter':
                        processQuery();
                        break;
                    case 'r':
                        e.preventDefault();
                        activateRainbowMode();
                        break;
                    case 'd':
                        e.preventDefault();
                        deepDive();
                        break;
                    case 'p':
                        e.preventDefault();
                        maxProtection();
                        break;
                }
            }
        });

        // PWA install prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            showNotification('Install Sovereign Gateway for offline access');
        });
    </script>
</body>
</html>