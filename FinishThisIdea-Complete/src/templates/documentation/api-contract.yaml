id: api-contract
name: API Contract
description: Complete API documentation with OpenAPI specifications
requiredAnalysis:
  - apis
  - dataModels
  - projectInfo
sections:
  - id: overview
    title: API Overview
    template: |
      ## API Overview
      
      This document describes the REST API for {{projectName}}.
      
      **Base URL**: `{{baseUrl}}`
      **Version**: {{version}}
      **Authentication**: {{authMethod}}
    dataMapping:
      - placeholder: "{{projectName}}"
        source: "projectInfo.name"
      - placeholder: "{{baseUrl}}"
        source: "projectInfo.baseUrl"
        default: "http://localhost:3000/api"
      - placeholder: "{{version}}"
        source: "projectInfo.version"
        default: "1.0.0"
      - placeholder: "{{authMethod}}"
        source: "apis[0].authentication"
        default: "To be determined"
  
  - id: endpoints
    title: API Endpoints
    template: |
      ## API Endpoints
      
      {{endpointTable}}
      
      ## Endpoint Details
      
      {{endpointDetails}}
    dataMapping:
      - placeholder: "{{endpointTable}}"
        source: "apis"
        transform: "generateEndpointTable"
      - placeholder: "{{endpointDetails}}"
        source: "apis"
        transform: "generateEndpointDetails"
    aiPrompt: "Generate detailed documentation for each API endpoint including parameters, request/response examples, and error cases."
  
  - id: openapi
    title: OpenAPI Specification
    template: |
      ## OpenAPI Specification
      
      ```yaml
      {{openapiSpec}}
      ```
    dataMapping:
      - placeholder: "{{openapiSpec}}"
        source: "apis"
        transform: "generateOpenAPISpec"
  
  - id: authentication
    title: Authentication & Authorization
    template: |
      ## Authentication
      
      {{authDetails}}
      
      ## Rate Limiting
      
      {{rateLimits}}
    dataMapping:
      - placeholder: "{{authDetails}}"
        source: "apis"
        transform: "extractAuthDetails"
      - placeholder: "{{rateLimits}}"
        source: "apis"
        transform: "generateRateLimits"
    aiPrompt: "Based on the API analysis, describe the authentication mechanisms and any rate limiting or access control measures."
  
  - id: errors
    title: Error Handling
    template: |
      ## Error Responses
      
      All errors follow a consistent format:
      
      ```json
      {
        "error": {
          "code": "ERROR_CODE",
          "message": "Human-readable error message",
          "details": {}
        }
      }
      ```
      
      ### Common Error Codes
      {{errorCodes}}
    dataMapping:
      - placeholder: "{{errorCodes}}"
        source: "apis"
        transform: "extractErrorCodes"
    aiPrompt: "List common error codes and their meanings based on the API implementation."