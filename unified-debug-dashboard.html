<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ‘‘ðŸ’ƒ Unified Debug Dashboard - The Royal Dance</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0a0a;
            color: #f0f0f0;
            overflow: hidden;
        }

        /* Split Screen Layout */
        .split-container {
            display: flex;
            height: 100vh;
            position: relative;
        }

        .king-side, .queen-side {
            flex: 1;
            height: 100%;
            position: relative;
            overflow: hidden;
        }

        /* King Side - Technical/Matrix Style */
        .king-side {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
            border-right: 2px solid #00ff88;
        }

        .king-side iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* Queen Side - Warm/Human Style */
        .queen-side {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .queen-side iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* Central Dance Floor */
        .dance-floor {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 100px;
            height: 100px;
            z-index: 1000;
            pointer-events: none;
        }

        .dance-connection {
            width: 100%;
            height: 100%;
            border: 3px solid transparent;
            border-radius: 50%;
            position: relative;
            animation: pulse 2s infinite;
        }

        .dance-connection.connected {
            border-color: #00ff88;
            box-shadow: 0 0 30px #00ff88, inset 0 0 30px #ff6b9d;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.2); opacity: 1; }
        }

        /* Dance Particles */
        .dance-particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #fff;
            border-radius: 50%;
            pointer-events: none;
        }

        .particle-king {
            background: #00ff88;
            animation: particleKing 3s infinite ease-in-out;
        }

        .particle-queen {
            background: #ff6b9d;
            animation: particleQueen 3s infinite ease-in-out;
        }

        @keyframes particleKing {
            0% { transform: translateX(-50px) translateY(0); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translateX(50px) translateY(0); opacity: 0; }
        }

        @keyframes particleQueen {
            0% { transform: translateX(50px) translateY(0); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translateX(-50px) translateY(0); opacity: 0; }
        }

        /* Control Panel */
        .control-panel {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 15px 30px;
            display: flex;
            gap: 20px;
            align-items: center;
            z-index: 1001;
        }

        .control-btn {
            padding: 8px 20px;
            background: transparent;
            border: 1px solid #00ff88;
            color: #00ff88;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .control-btn:hover {
            background: #00ff88;
            color: #0a0a0a;
            transform: translateY(-2px);
        }

        .control-btn.queen-style {
            border-color: #ff6b9d;
            color: #ff6b9d;
        }

        .control-btn.queen-style:hover {
            background: #ff6b9d;
            color: #fff;
        }

        /* Mode Indicators */
        .mode-indicator {
            position: absolute;
            top: 20px;
            padding: 10px 20px;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            border-radius: 20px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .king-indicator {
            left: 20px;
            border: 1px solid #00ff88;
            color: #00ff88;
        }

        .queen-indicator {
            right: 20px;
            border: 1px solid #ff6b9d;
            color: #ff6b9d;
        }

        /* NATO Tools Display */
        .nato-tools {
            position: absolute;
            top: 80px;
            width: 200px;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            border-radius: 10px;
            padding: 15px;
            font-size: 12px;
        }

        .nato-tools.king-tools {
            left: 20px;
            border: 1px solid #00ff88;
        }

        .nato-tools.queen-tools {
            right: 20px;
            border: 1px solid #ff6b9d;
        }

        .tool-pair {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            opacity: 0.8;
        }

        .tool-pair:hover {
            opacity: 1;
        }

        /* Loading State */
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            animation: loadingPulse 1s infinite;
        }

        @keyframes loadingPulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        /* Dance Mode Effects */
        body.dance-mode .split-container {
            animation: sway 4s ease-in-out infinite;
        }

        @keyframes sway {
            0%, 100% { transform: rotate(-0.5deg); }
            50% { transform: rotate(0.5deg); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .split-container {
                flex-direction: column;
            }
            
            .king-side {
                border-right: none;
                border-bottom: 2px solid #00ff88;
            }
            
            .control-panel {
                flex-wrap: wrap;
                bottom: 10px;
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="split-container">
        <!-- King Side -->
        <div class="king-side">
            <div class="loading" id="kingLoading">ðŸ‘‘ Loading King Dashboard...</div>
            <iframe id="kingFrame" style="display: none;"></iframe>
        </div>

        <!-- Queen Side -->
        <div class="queen-side">
            <div class="loading" id="queenLoading">ðŸ‘¸ Loading Queen Dashboard...</div>
            <iframe id="queenFrame" style="display: none;"></iframe>
        </div>

        <!-- Dance Floor Connection -->
        <div class="dance-floor">
            <div class="dance-connection" id="danceConnection"></div>
        </div>
    </div>

    <!-- Mode Indicators -->
    <div class="mode-indicator king-indicator">
        <span>ðŸ‘‘</span>
        <span>Master Controller</span>
        <span id="kingStatus">Loading...</span>
    </div>

    <div class="mode-indicator queen-indicator">
        <span>ðŸ‘¸</span>
        <span>Journey Orchestrator</span>
        <span id="queenStatus">Loading...</span>
    </div>

    <!-- NATO Tools -->
    <div class="nato-tools king-tools">
        <h4 style="color: #00ff88; margin-bottom: 10px;">King Tools (Technical)</h4>
        <div class="tool-pair"><span>A</span><span>Analyzer</span></div>
        <div class="tool-pair"><span>B</span><span>Backend Monitor</span></div>
        <div class="tool-pair"><span>C</span><span>Container Health</span></div>
        <div class="tool-pair"><span>D</span><span>Database Status</span></div>
        <div class="tool-pair"><span>E</span><span>Error Logger</span></div>
    </div>

    <div class="nato-tools queen-tools">
        <h4 style="color: #ff6b9d; margin-bottom: 10px;">Queen Tools (Human)</h4>
        <div class="tool-pair"><span>A</span><span>Awareness</span></div>
        <div class="tool-pair"><span>B</span><span>Behavior Track</span></div>
        <div class="tool-pair"><span>C</span><span>Customer Care</span></div>
        <div class="tool-pair"><span>D</span><span>Data Delight</span></div>
        <div class="tool-pair"><span>E</span><span>Empathy Engine</span></div>
    </div>

    <!-- Control Panel -->
    <div class="control-panel">
        <button class="control-btn" onclick="startDance()">ðŸ’ƒ Start Dance</button>
        <button class="control-btn" onclick="syncDashboards()">ðŸ”„ Sync Views</button>
        <button class="control-btn queen-style" onclick="toggleMode()">ðŸŽ­ Toggle Mode</button>
        <button class="control-btn" onclick="openBridge()">ðŸŒ‰ Open Bridge</button>
    </div>

    <script>
        let isConnected = false;
        let isDancing = false;
        let bridgeWs = null;

        // Load dashboards
        function loadDashboards() {
            const kingFrame = document.getElementById('kingFrame');
            const queenFrame = document.getElementById('queenFrame');
            
            // Load King Dashboard (Master Controller)
            kingFrame.src = 'http://localhost:9999';
            kingFrame.onload = () => {
                document.getElementById('kingLoading').style.display = 'none';
                kingFrame.style.display = 'block';
                document.getElementById('kingStatus').textContent = 'Connected';
                checkConnection();
            };
            
            // Load Queen Dashboard
            queenFrame.src = 'queen-dashboard.html';
            queenFrame.onload = () => {
                document.getElementById('queenLoading').style.display = 'none';
                queenFrame.style.display = 'block';
                document.getElementById('queenStatus').textContent = 'Connected';
                checkConnection();
            };
        }

        // Check if both dashboards are connected
        function checkConnection() {
            const kingFrame = document.getElementById('kingFrame');
            const queenFrame = document.getElementById('queenFrame');
            
            if (kingFrame.style.display === 'block' && queenFrame.style.display === 'block') {
                isConnected = true;
                document.getElementById('danceConnection').classList.add('connected');
                createDanceParticles();
            }
        }

        // Create dance particles
        function createDanceParticles() {
            const danceFloor = document.querySelector('.dance-floor');
            
            setInterval(() => {
                if (isDancing) {
                    // King particle
                    const kingParticle = document.createElement('div');
                    kingParticle.className = 'dance-particle particle-king';
                    kingParticle.style.top = Math.random() * 100 + 'px';
                    danceFloor.appendChild(kingParticle);
                    
                    // Queen particle
                    const queenParticle = document.createElement('div');
                    queenParticle.className = 'dance-particle particle-queen';
                    queenParticle.style.top = Math.random() * 100 + 'px';
                    danceFloor.appendChild(queenParticle);
                    
                    // Remove particles after animation
                    setTimeout(() => {
                        kingParticle.remove();
                        queenParticle.remove();
                    }, 3000);
                }
            }, 500);
        }

        // Start the dance
        function startDance() {
            if (!isConnected) {
                alert('Both dashboards must be connected to dance!');
                return;
            }
            
            isDancing = !isDancing;
            document.body.classList.toggle('dance-mode', isDancing);
            
            // Connect to bridge if available
            if (!bridgeWs) {
                connectToBridge();
            }
            
            // Send dance command to both dashboards
            if (bridgeWs && bridgeWs.readyState === WebSocket.OPEN) {
                bridgeWs.send(JSON.stringify({
                    type: 'unified_dance',
                    dancing: isDancing
                }));
            }
        }

        // Connect to King-Queen Bridge
        function connectToBridge() {
            try {
                bridgeWs = new WebSocket('ws://localhost:9998/queen-bridge');
                
                bridgeWs.onopen = () => {
                    console.log('ðŸŒ‰ Connected to King-Queen Bridge');
                };
                
                bridgeWs.onmessage = (event) => {
                    const data = JSON.parse(event.data);
                    handleBridgeMessage(data);
                };
                
                bridgeWs.onclose = () => {
                    console.log('ðŸŒ‰ Bridge connection closed');
                    bridgeWs = null;
                };
            } catch (error) {
                console.error('Failed to connect to bridge:', error);
            }
        }

        // Handle bridge messages
        function handleBridgeMessage(data) {
            console.log('Bridge message:', data);
            
            // Could update UI based on bridge events
            switch (data.type) {
                case 'waltz_step':
                    // Show waltz animation
                    break;
                case 'system_health':
                    // Update health indicators
                    break;
            }
        }

        // Sync dashboards
        function syncDashboards() {
            if (!isConnected) return;
            
            // Flash sync animation
            const connection = document.getElementById('danceConnection');
            connection.style.animation = 'none';
            setTimeout(() => {
                connection.style.animation = 'pulse 2s infinite';
            }, 10);
            
            // Could send sync command to both dashboards
            console.log('ðŸ”„ Syncing King and Queen dashboards...');
        }

        // Toggle between modes
        function toggleMode() {
            // Could switch between split view and overlay view
            const container = document.querySelector('.split-container');
            container.style.flexDirection = 
                container.style.flexDirection === 'column' ? 'row' : 'column';
        }

        // Open bridge control panel
        function openBridge() {
            window.open('http://localhost:9998/status', '_blank');
        }

        // Initialize
        window.onload = () => {
            loadDashboards();
            
            // Try to connect to bridge after a delay
            setTimeout(connectToBridge, 2000);
        };

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'd' && e.metaKey) {
                e.preventDefault();
                startDance();
            } else if (e.key === 's' && e.metaKey) {
                e.preventDefault();
                syncDashboards();
            }
        });
    </script>
</body>
</html>