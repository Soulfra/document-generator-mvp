{{#> layout title="Achievement Unlocked!"}}
  <table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="margin: 0 auto;">
    <tr>
      <td align="center" style="padding: 40px 0;">
        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); width: 100px; height: 100px; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);">
          <span style="font-size: 50px;">{{achievement.icon}}</span>
        </div>
      </td>
    </tr>
    
    <tr>
      <td align="center" style="padding: 0 20px 30px;">
        <h1 style="margin: 0 0 10px; font-size: 32px; font-weight: 700; color: #1a1a1a;">
          Achievement Unlocked!
        </h1>
        <h2 style="margin: 0 0 10px; font-size: 24px; font-weight: 600; color: #667eea;">
          {{achievement.name}}
        </h2>
        <p style="margin: 0; font-size: 16px; color: #666;">
          {{achievement.description}}
        </p>
      </td>
    </tr>

    <tr>
      <td style="padding: 0 20px;">
        <div style="background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 12px; padding: 30px; margin-bottom: 30px; text-align: center;">
          <div style="display: inline-flex; gap: 40px; flex-wrap: wrap; justify-content: center;">
            <div>
              <div style="font-size: 32px; font-weight: 700; color: #667eea;">+{{achievement.points}}</div>
              <div style="font-size: 14px; color: #666; text-transform: uppercase; letter-spacing: 1px;">Points</div>
            </div>
            {{#if achievement.rewards.tokens}}
            <div>
              <div style="font-size: 32px; font-weight: 700; color: #f39c12;">+{{achievement.rewards.tokens}}</div>
              <div style="font-size: 14px; color: #666; text-transform: uppercase; letter-spacing: 1px;">Tokens</div>
            </div>
            {{/if}}
            <div>
              <div style="font-size: 14px; color: #666; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px;">Rarity</div>
              <div style="
                display: inline-block;
                padding: 4px 12px;
                border-radius: 20px;
                font-size: 12px;
                font-weight: 600;
                text-transform: uppercase;
                {{#eq achievement.rarity 'common'}}background: #e0e0e0; color: #616161;{{/eq}}
                {{#eq achievement.rarity 'uncommon'}}background: #81c784; color: #2e7d32;{{/eq}}
                {{#eq achievement.rarity 'rare'}}background: #64b5f6; color: #1565c0;{{/eq}}
                {{#eq achievement.rarity 'epic'}}background: #ba68c8; color: #6a1b9a;{{/eq}}
                {{#eq achievement.rarity 'legendary'}}background: linear-gradient(135deg, #ffd700, #ffed4e); color: #b8860b;{{/eq}}
              ">
                {{achievement.rarity}}
              </div>
            </div>
          </div>
        </div>
      </td>
    </tr>

    {{#if achievement.rewards.badge}}
    <tr>
      <td style="padding: 0 20px;">
        <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 8px; padding: 20px; margin-bottom: 20px; text-align: center;">
          <h4 style="margin: 0 0 10px; font-size: 16px; font-weight: 600; color: #856404;">
            üèÖ New Badge Earned!
          </h4>
          <p style="margin: 0; font-size: 14px; color: #856404;">
            You've earned the <strong>{{achievement.rewards.badge}}</strong> badge
          </p>
        </div>
      </td>
    </tr>
    {{/if}}

    {{#if achievement.rewards.title}}
    <tr>
      <td style="padding: 0 20px;">
        <div style="background: #d4edda; border: 1px solid #c3e6cb; border-radius: 8px; padding: 20px; margin-bottom: 20px; text-align: center;">
          <h4 style="margin: 0 0 10px; font-size: 16px; font-weight: 600; color: #155724;">
            üëë New Title Unlocked!
          </h4>
          <p style="margin: 0; font-size: 14px; color: #155724;">
            You can now use the title: <strong>{{achievement.rewards.title}}</strong>
          </p>
        </div>
      </td>
    </tr>
    {{/if}}

    {{#if levelUp}}
    <tr>
      <td style="padding: 0 20px;">
        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; padding: 30px; margin-bottom: 30px; text-align: center; color: white;">
          <h3 style="margin: 0 0 15px; font-size: 24px; font-weight: 700;">
            üéâ LEVEL UP!
          </h3>
          <div style="font-size: 48px; font-weight: 700; margin-bottom: 10px;">
            Level {{userLevel}}
          </div>
          <div style="font-size: 20px; font-weight: 600; margin-bottom: 20px;">
            {{levelTitle}}
          </div>
          <p style="margin: 0; font-size: 14px; opacity: 0.9;">
            New perks unlocked! Check your dashboard for details.
          </p>
        </div>
      </td>
    </tr>
    {{/if}}

    <tr>
      <td style="padding: 0 20px;">
        <div style="background: #f8f9fa; border-radius: 8px; padding: 25px; margin-bottom: 30px;">
          <h4 style="margin: 0 0 15px; font-size: 18px; font-weight: 600; color: #1a1a1a;">
            Your Progress
          </h4>
          <div style="margin-bottom: 15px;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
              <span style="font-size: 14px; color: #666;">Level {{userLevel}} Progress</span>
              <span style="font-size: 14px; color: #666;">{{userXP}}/{{nextLevelXP}} XP</span>
            </div>
            <div style="background: #e0e0e0; height: 8px; border-radius: 4px; overflow: hidden;">
              <div style="background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); height: 100%; width: {{levelProgress}}%; transition: width 0.3s ease;"></div>
            </div>
          </div>
          <div style="display: flex; justify-content: space-around; text-align: center;">
            <div>
              <div style="font-size: 24px; font-weight: 700; color: #1a1a1a;">{{totalAchievements}}</div>
              <div style="font-size: 12px; color: #666;">Achievements</div>
            </div>
            <div>
              <div style="font-size: 24px; font-weight: 700; color: #1a1a1a;">{{totalPoints}}</div>
              <div style="font-size: 12px; color: #666;">Total Points</div>
            </div>
            <div>
              <div style="font-size: 24px; font-weight: 700; color: #1a1a1a;">{{totalTokens}}</div>
              <div style="font-size: 12px; color: #666;">Tokens</div>
            </div>
          </div>
        </div>
      </td>
    </tr>

    <tr>
      <td align="center" style="padding: 0 20px 40px;">
        <a href="{{achievementsUrl}}" style="display: inline-block; background: #667eea; color: white; text-decoration: none; padding: 14px 32px; border-radius: 8px; font-weight: 600; font-size: 16px; margin-right: 10px;">
          View All Achievements
        </a>
        <a href="{{shareUrl}}" style="display: inline-block; background: #1DA1F2; color: white; text-decoration: none; padding: 14px 32px; border-radius: 8px; font-weight: 600; font-size: 16px;">
          Share Achievement
        </a>
      </td>
    </tr>

    <tr>
      <td style="padding: 0 20px 40px;">
        <div style="background: #f8f9fa; border-radius: 8px; padding: 20px; text-align: center;">
          <h4 style="margin: 0 0 10px; font-size: 16px; font-weight: 600; color: #1a1a1a;">
            Next Achievement
          </h4>
          <p style="margin: 0; font-size: 14px; color: #666;">
            You're {{nextAchievementProgress}}% of the way to unlocking <strong>{{nextAchievementName}}</strong>
          </p>
        </div>
      </td>
    </tr>
  </table>
{{/layout}}