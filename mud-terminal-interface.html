<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎮💰 Revenue MUD - Developer's Paradise</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #000;
            color: #00ff41;
            font-family: 'Courier New', 'Monaco', 'Lucida Console', monospace;
            font-size: 14px;
            line-height: 1.4;
            overflow: hidden;
            height: 100vh;
        }

        /* Main container - optimized for 1920x1080 streaming */
        .main-container {
            display: grid;
            grid-template-areas: 
                "header header revenue"
                "terminal terminal sidebar";
            grid-template-rows: 60px 1fr;
            grid-template-columns: 1fr 300px;
            height: 100vh;
            gap: 2px;
            background: #001100;
        }

        /* Header - Stream title and branding */
        .header {
            grid-area: header;
            background: linear-gradient(90deg, #002200, #004400);
            border: 2px solid #00ff41;
            padding: 10px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .header h1 {
            color: #00ff41;
            font-size: 20px;
            text-shadow: 0 0 10px #00ff41;
        }

        .header .tagline {
            color: #88cc88;
            font-size: 12px;
        }

        /* Revenue counter - top right for streaming visibility */
        .revenue-display {
            grid-area: revenue;
            background: rgba(0, 40, 0, 0.9);
            border: 2px solid #00ff41;
            padding: 15px;
            text-align: center;
        }

        .total-revenue {
            font-size: 24px;
            color: #00ff00;
            font-weight: bold;
            text-shadow: 0 0 10px #00ff00;
        }

        .revenue-breakdown {
            font-size: 10px;
            margin-top: 5px;
            opacity: 0.8;
        }

        /* Main terminal area */
        .terminal-container {
            grid-area: terminal;
            background: #000;
            border: 2px solid #00ff41;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .terminal-output {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            white-space: pre-wrap;
            background: 
                radial-gradient(circle at 25% 25%, #001100 0%, transparent 50%),
                linear-gradient(0deg, transparent 95%, rgba(0, 255, 65, 0.03) 100%);
        }

        .terminal-input-area {
            border-top: 1px solid #004400;
            padding: 10px 20px;
            display: flex;
            align-items: center;
            background: rgba(0, 20, 0, 0.8);
        }

        .terminal-prompt {
            color: #00ff41;
            margin-right: 10px;
        }

        .terminal-input {
            flex: 1;
            background: transparent;
            border: none;
            color: #00ff41;
            font-family: inherit;
            font-size: inherit;
            outline: none;
        }

        /* Sidebar - streaming stats and controls */
        .sidebar {
            grid-area: sidebar;
            background: rgba(0, 20, 0, 0.9);
            border: 2px solid #00ff41;
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 15px;
        }

        .sidebar-section {
            background: rgba(0, 40, 0, 0.5);
            border: 1px solid #004400;
            border-radius: 5px;
            padding: 10px;
        }

        .sidebar-section h3 {
            color: #00ff41;
            font-size: 14px;
            margin-bottom: 8px;
            text-align: center;
        }

        /* Stream chat integration */
        .stream-chat {
            height: 200px;
            overflow-y: auto;
            font-size: 12px;
        }

        .chat-message {
            margin-bottom: 5px;
            padding: 3px;
            border-left: 2px solid transparent;
            padding-left: 8px;
        }

        .chat-message.roast {
            border-left-color: #ff6600;
            background: rgba(255, 102, 0, 0.1);
        }

        .chat-message.donation {
            border-left-color: #ffd700;
            background: rgba(255, 215, 0, 0.1);
        }

        .chat-username {
            color: #88cc88;
            font-weight: bold;
        }

        /* D-pad visual indicator */
        .dpad-indicator {
            position: absolute;
            bottom: 10px;
            right: 10px;
            opacity: 0.6;
            font-size: 12px;
        }

        .dpad-grid {
            display: grid;
            grid-template-areas:
                ". up ."
                "left . right"
                ". down .";
            grid-template-columns: 30px 30px 30px;
            grid-template-rows: 30px 30px 30px;
            gap: 2px;
        }

        .dpad-key {
            background: rgba(0, 255, 65, 0.2);
            border: 1px solid #004400;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            transition: all 0.1s;
        }

        .dpad-key.active {
            background: rgba(0, 255, 65, 0.5);
            border-color: #00ff41;
        }

        .dpad-key.up { grid-area: up; }
        .dpad-key.down { grid-area: down; }
        .dpad-key.left { grid-area: left; }
        .dpad-key.right { grid-area: right; }

        /* Affiliate product showcase */
        .affiliate-showcase {
            height: 120px;
            text-align: center;
            display: none;
        }

        .affiliate-showcase.active {
            display: block;
        }

        .product-name {
            color: #00ff00;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .product-price {
            color: #ffd700;
            font-size: 14px;
        }

        .commission-info {
            font-size: 10px;
            opacity: 0.8;
            margin-top: 5px;
        }

        .buy-button {
            background: #ff6600;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 10px;
            margin-top: 8px;
            cursor: pointer;
            font-family: inherit;
        }

        .buy-button:hover {
            background: #ff8833;
        }

        /* Emacs mode indicator */
        .emacs-mode {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(138, 43, 226, 0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            display: none;
        }

        .emacs-mode.active {
            display: block;
        }

        /* Animation effects */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Terminal text effects */
        .cal-response {
            color: #ff6600;
            font-weight: bold;
            background: rgba(255, 102, 0, 0.1);
            padding: 5px;
            border-left: 3px solid #ff6600;
            margin: 10px 0;
        }

        .system-message {
            color: #88cc88;
            font-style: italic;
        }

        .error-message {
            color: #ff4444;
        }

        .success-message {
            color: #00ff00;
        }

        /* Donation alert overlay */
        .donation-alert {
            position: fixed;
            top: 20%;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #000;
            padding: 20px 30px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            z-index: 1000;
            display: none;
            text-align: center;
            border: 3px solid #ff6600;
        }

        .donation-alert.active {
            display: block;
            animation: donationBounce 0.5s ease-out;
        }

        @keyframes donationBounce {
            0% { transform: translateX(-50%) scale(0.5) rotate(-5deg); }
            50% { transform: translateX(-50%) scale(1.1) rotate(2deg); }
            100% { transform: translateX(-50%) scale(1) rotate(0deg); }
        }

        /* Responsive for smaller screens */
        @media (max-width: 1200px) {
            .main-container {
                grid-template-areas: 
                    "header revenue"
                    "terminal terminal"
                    "sidebar sidebar";
                grid-template-rows: 60px 1fr 200px;
                grid-template-columns: 1fr 200px;
            }
            
            .sidebar {
                flex-direction: row;
                overflow-x: auto;
            }
            
            .sidebar-section {
                min-width: 200px;
            }
        }

        /* Cal AI ASCII art styling */
        .ascii-art {
            font-family: 'Courier New', monospace;
            font-size: 10px;
            line-height: 1;
            white-space: pre;
            color: #00ff41;
            text-shadow: 0 0 5px #00ff41;
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #004400;
            background: rgba(0, 20, 0, 0.5);
        }

        .ascii-art.legendary {
            color: #ffd700;
            text-shadow: 0 0 10px #ffd700;
            border-color: #ffd700;
            animation: pulse 1s infinite;
        }

        .ascii-art.rare {
            color: #ff6600;
            text-shadow: 0 0 8px #ff6600;
            border-color: #ff6600;
        }
    </style>
</head>
<body>
    <!-- Main layout optimized for streaming -->
    <div class="main-container">
        <!-- Header with stream branding -->
        <div class="header">
            <div>
                <h1>🎮 Revenue MUD</h1>
                <div class="tagline">The developer's paradise with Cal AI</div>
            </div>
            <div class="stream-info">
                <span id="playerCount">0 players</span> • 
                <span id="viewerCount">0 viewers</span>
            </div>
        </div>

        <!-- Revenue counter - prominently displayed for streaming -->
        <div class="revenue-display">
            <div>💰 Total Revenue</div>
            <div class="total-revenue pulse">$<span id="totalRevenue">0.00</span></div>
            <div class="revenue-breakdown">
                🎬 Stream: $<span id="streamRevenue">0.00</span><br>
                🎮 MUD: $<span id="mudRevenue">0.00</span><br>
                🔗 Affiliate: <span id="affiliateClicks">0</span>
            </div>
        </div>

        <!-- Main terminal interface -->
        <div class="terminal-container">
            <div class="emacs-mode" id="emacsMode">⌨️ EMACS MODE ACTIVE</div>
            
            <div class="terminal-output" id="terminalOutput">
                <div class="system-message">🎮 Revenue MUD Terminal v1.0.0 - Connecting to server...</div>
                <div class="system-message">💰 Monetization systems active</div>
                <div class="system-message">🎬 Streaming integration ready</div>
                <div class="system-message">Type 'help' for commands, or use WASD/arrow keys to move!</div>
            </div>

            <div class="terminal-input-area">
                <div class="terminal-prompt">MUD></div>
                <input type="text" class="terminal-input" id="commandInput" 
                       placeholder="Enter command or use WASD/arrow keys..." autofocus>
            </div>

            <!-- D-pad indicator for streaming viewers -->
            <div class="dpad-indicator">
                <div>Movement:</div>
                <div class="dpad-grid">
                    <div class="dpad-key up" id="dpadUp">↑<br>W</div>
                    <div class="dpad-key left" id="dpadLeft">←<br>A</div>
                    <div class="dpad-key right" id="dpadRight">→<br>D</div>
                    <div class="dpad-key down" id="dpadDown">↓<br>S</div>
                </div>
            </div>
        </div>

        <!-- Sidebar with streaming features -->
        <div class="sidebar">
            <!-- Stream chat integration -->
            <div class="sidebar-section">
                <h3>💬 Stream Chat</h3>
                <div class="stream-chat" id="streamChat">
                    <div class="chat-message">
                        <span class="chat-username">System:</span> Chat integration active!
                    </div>
                </div>
            </div>

            <!-- Live stats -->
            <div class="sidebar-section">
                <h3>📊 Live Stats</h3>
                <div id="liveStats">
                    <div>🎮 Players: <span id="sidebarPlayers">0</span></div>
                    <div>👥 Viewers: <span id="sidebarViewers">0</span></div>
                    <div>🤖 Cal spawns: <span id="calSpawns">0</span></div>
                    <div>💰 Revenue/hr: <span id="revenuePerHour">$0.00</span></div>
                </div>
            </div>

            <!-- Affiliate showcase -->
            <div class="sidebar-section">
                <h3>🛒 Featured Product</h3>
                <div class="affiliate-showcase" id="affiliateShowcase">
                    <div class="product-name" id="productName">Das Keyboard Ultimate</div>
                    <div class="product-price">$<span id="productPrice">169</span></div>
                    <div class="commission-info">Commission: $<span id="commission">15</span></div>
                    <button class="buy-button" id="buyButton">Buy & Support Stream!</button>
                </div>
            </div>

            <!-- Quick commands -->
            <div class="sidebar-section">
                <h3>⚡ Quick Commands</h3>
                <div style="font-size: 11px;">
                    <div><strong>Movement:</strong> WASD or arrows</div>
                    <div><strong>Chat:</strong> say &lt;message&gt;</div>
                    <div><strong>Revenue:</strong> revenue</div>
                    <div><strong>Emacs:</strong> emacs &lt;cmd&gt;</div>
                    <div><strong>Shop:</strong> talk merchant_alex</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Donation alert overlay -->
    <div class="donation-alert" id="donationAlert">
        <div id="donationMessage">Thank you for the donation!</div>
    </div>

    <script>
        class MUDInterface {
            constructor() {
                this.ws = null;
                this.streamWs = null;
                this.emacsMode = false;
                this.commandHistory = [];
                this.historyIndex = -1;
                this.calSpawns = 0;
                this.startTime = Date.now();
                
                this.initializeInterface();
                this.connectToMUD();
                this.connectToStreaming();
                this.startStatsUpdates();
            }
            
            initializeInterface() {
                const commandInput = document.getElementById('commandInput');
                
                // Command input handling
                commandInput.addEventListener('keydown', (e) => {
                    this.handleKeyPress(e);
                });
                
                // D-pad visual feedback
                this.setupDPadIndicators();
                
                // Affiliate button
                document.getElementById('buyButton').addEventListener('click', () => {
                    this.handleAffiliateClick();
                });
                
                console.log('🎮 MUD Interface initialized');
            }
            
            connectToMUD() {
                try {
                    this.ws = new WebSocket('ws://localhost:3030');
                    
                    this.ws.onopen = () => {
                        this.addToOutput('🎮 Connected to Revenue MUD!', 'success-message');
                        this.updateConnectionStatus(true);
                    };
                    
                    this.ws.onmessage = (event) => {
                        const data = JSON.parse(event.data);
                        this.handleMUDMessage(data);
                    };
                    
                    this.ws.onclose = () => {
                        this.addToOutput('❌ Disconnected from MUD server. Trying to reconnect...', 'error-message');
                        this.updateConnectionStatus(false);
                        
                        // Auto-reconnect after 3 seconds
                        setTimeout(() => this.connectToMUD(), 3000);
                    };
                    
                } catch (error) {
                    console.error('MUD connection error:', error);
                    this.addToOutput('❌ Could not connect to MUD server. Starting in demo mode...', 'error-message');
                    this.startDemoMode();
                }
            }
            
            connectToStreaming() {
                try {
                    this.streamWs = new WebSocket('ws://localhost:8888');
                    
                    this.streamWs.onopen = () => {
                        console.log('🎬 Connected to streaming layer');
                    };
                    
                    this.streamWs.onmessage = (event) => {
                        const data = JSON.parse(event.data);
                        this.handleStreamMessage(data);
                    };
                    
                } catch (error) {
                    console.error('Streaming connection error:', error);
                }
            }
            
            handleKeyPress(e) {
                const input = e.target;
                
                if (e.key === 'Enter') {
                    const command = input.value.trim();
                    if (command) {
                        this.sendCommand(command);
                        this.commandHistory.unshift(command);
                        this.historyIndex = -1;
                        input.value = '';
                    }
                    return;
                }
                
                // Command history navigation
                if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    if (this.historyIndex < this.commandHistory.length - 1) {
                        this.historyIndex++;
                        input.value = this.commandHistory[this.historyIndex];
                    }
                    return;
                }
                
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    if (this.historyIndex > -1) {
                        this.historyIndex--;
                        input.value = this.historyIndex >= 0 ? this.commandHistory[this.historyIndex] : '';
                    }
                    return;
                }
                
                // Movement keys (when input is focused)
                const movementKeys = {
                    'ArrowUp': 'north',
                    'ArrowDown': 'south', 
                    'ArrowLeft': 'west',
                    'ArrowRight': 'east',
                    'KeyW': 'north',
                    'KeyS': 'south',
                    'KeyA': 'west',
                    'KeyD': 'east'
                };
                
                if (movementKeys[e.code] && input.value === '') {
                    e.preventDefault();
                    this.sendCommand(`move ${movementKeys[e.code]}`);
                    this.animateDPad(e.code);
                }
                
                // Emacs keybindings
                if (this.emacsMode) {
                    this.handleEmacsKeys(e);
                }
            }
            
            handleEmacsKeys(e) {
                // Ctrl+X Ctrl+S (save)
                if (e.ctrlKey && e.key === 'x') {
                    e.preventDefault();
                    this.addToOutput('🔥 Emacs: Ctrl-X pressed, waiting for next key...', 'system-message');
                    
                    const nextKeyHandler = (nextE) => {
                        if (nextE.ctrlKey && nextE.key === 's') {
                            nextE.preventDefault();
                            this.sendCommand('emacs C-x C-s');
                            document.removeEventListener('keydown', nextKeyHandler);
                        }
                    };
                    document.addEventListener('keydown', nextKeyHandler);
                }
                
                // Ctrl+G (cancel)
                if (e.ctrlKey && e.key === 'g') {
                    e.preventDefault();
                    this.sendCommand('emacs C-g');
                }
            }
            
            setupDPadIndicators() {
                // Add click handlers to D-pad
                document.getElementById('dpadUp').onclick = () => this.sendCommand('move north');
                document.getElementById('dpadDown').onclick = () => this.sendCommand('move south');
                document.getElementById('dpadLeft').onclick = () => this.sendCommand('move west');
                document.getElementById('dpadRight').onclick = () => this.sendCommand('move east');
            }
            
            animateDPad(keyCode) {
                const keyMap = {
                    'ArrowUp': 'dpadUp',
                    'ArrowDown': 'dpadDown', 
                    'ArrowLeft': 'dpadLeft',
                    'ArrowRight': 'dpadRight',
                    'KeyW': 'dpadUp',
                    'KeyS': 'dpadDown',
                    'KeyA': 'dpadLeft',
                    'KeyD': 'dpadRight'
                };
                
                const element = document.getElementById(keyMap[keyCode]);
                if (element) {
                    element.classList.add('active');
                    setTimeout(() => element.classList.remove('active'), 200);
                }
            }
            
            sendCommand(command) {
                this.addToOutput(`MUD> ${command}`);
                
                if (this.ws && this.ws.readyState === WebSocket.OPEN) {
                    // Parse command
                    const parts = command.split(' ');
                    const action = parts[0];
                    const params = {};
                    
                    switch (action) {
                        case 'move':
                            params.direction = parts[1];
                            break;
                        case 'talk':
                            params.npc = parts[1];
                            break;
                        case 'buy':
                            params.item = parts[1];
                            break;
                        case 'say':
                            params.message = parts.slice(1).join(' ');
                            break;
                        case 'emacs':
                            params.command = parts.slice(1).join(' ');
                            break;
                        case 'stream':
                            params.subcommand = parts[1];
                            break;
                        default:
                            // Simple commands
                            break;
                    }
                    
                    this.ws.send(JSON.stringify({ action, params }));
                } else {
                    this.handleDemoCommand(command);
                }
            }
            
            handleMUDMessage(data) {
                switch (data.type) {
                    case 'welcome':
                        this.addToOutput(data.message, 'success-message');
                        break;
                        
                    case 'room_description':
                        this.addToOutput(data.message, 'system-message');
                        break;
                        
                    case 'cal_spawn':
                        this.calSpawns++;
                        this.addToOutput(data.message, 'cal-response');
                        if (data.ascii) {
                            this.addToOutput(data.ascii, 'ascii-art');
                        }
                        this.updateCalSpawns();
                        break;
                        
                    case 'cal_response':
                        this.addToOutput(`🤖 ${data.npc}: ${data.message}`, 'cal-response');
                        if (data.ascii) {
                            const artClass = data.rarity === 'LEGENDARY' ? 'ascii-art legendary' : 
                                           data.rarity === 'RARE' ? 'ascii-art rare' : 'ascii-art';
                            this.addToOutput(data.ascii, artClass);
                        }
                        
                        // Add to stream chat
                        this.addStreamChat('Cal AI', data.message.substring(0, 50) + '...', 'roast');
                        break;
                        
                    case 'purchase':
                        this.addToOutput(data.message, 'success-message');
                        this.trackAffiliateClick(data.item, data.commission);
                        break;
                        
                    case 'revenue_stats':
                        this.addToOutput(data.message, 'system-message');
                        break;
                        
                    case 'emacs_lesson':
                        this.addToOutput(data.message, 'success-message');
                        if (data.ascii) {
                            this.addToOutput(data.ascii, 'ascii-art');
                        }
                        this.toggleEmacsMode(true);
                        break;
                        
                    case 'error':
                        this.addToOutput(data.message, 'error-message');
                        break;
                        
                    default:
                        this.addToOutput(data.message || JSON.stringify(data));
                }
            }
            
            handleStreamMessage(data) {
                switch (data.type) {
                    case 'revenue_update':
                        this.updateRevenueDisplay(data);
                        break;
                        
                    case 'donation':
                        this.showDonationAlert(data.user, data.amount);
                        this.addStreamChat(data.user, `donated $${data.amount}!`, 'donation');
                        break;
                        
                    case 'cal_roast':
                        this.addStreamChat(data.user, `!roast → ${data.roast.substring(0, 30)}...`, 'roast');
                        break;
                        
                    case 'affiliate_showcase':
                        this.showAffiliateProduct(data.product);
                        break;
                }
            }
            
            addToOutput(text, className = '') {
                const output = document.getElementById('terminalOutput');
                const div = document.createElement('div');
                div.textContent = text;
                if (className) {
                    div.className = className;
                }
                output.appendChild(div);
                
                // Auto-scroll
                output.scrollTop = output.scrollHeight;
                
                // Keep only last 1000 lines for performance
                while (output.children.length > 1000) {
                    output.removeChild(output.firstChild);
                }
            }
            
            addStreamChat(username, message, type = '') {
                const chat = document.getElementById('streamChat');
                const div = document.createElement('div');
                div.className = 'chat-message ' + type;
                div.innerHTML = `<span class="chat-username">${username}:</span> ${message}`;
                chat.appendChild(div);
                
                // Keep only last 50 messages
                while (chat.children.length > 50) {
                    chat.removeChild(chat.firstChild);
                }
                
                chat.scrollTop = chat.scrollHeight;
            }
            
            updateRevenueDisplay(data) {
                document.getElementById('totalRevenue').textContent = data.total.toFixed(2);
                document.getElementById('streamRevenue').textContent = data.stream.toFixed(2);
                document.getElementById('mudRevenue').textContent = data.mud.toFixed(2);
                document.getElementById('sidebarViewers').textContent = data.viewers;
            }
            
            updateCalSpawns() {
                document.getElementById('calSpawns').textContent = this.calSpawns;
            }
            
            showDonationAlert(user, amount) {
                const alert = document.getElementById('donationAlert');
                const message = document.getElementById('donationMessage');
                message.textContent = `${user} donated $${amount}! Thank you! 🎉`;
                
                alert.classList.add('active');
                
                setTimeout(() => {
                    alert.classList.remove('active');
                }, 5000);
            }
            
            showAffiliateProduct(product) {
                const showcase = document.getElementById('affiliateShowcase');
                document.getElementById('productName').textContent = product.name;
                document.getElementById('productPrice').textContent = product.price;
                document.getElementById('commission').textContent = product.commission;
                
                showcase.classList.add('active');
                
                setTimeout(() => {
                    showcase.classList.remove('active');
                }, 10000);
            }
            
            handleAffiliateClick() {
                // Track click and open affiliate link
                const productName = document.getElementById('productName').textContent;
                
                if (this.streamWs && this.streamWs.readyState === WebSocket.OPEN) {
                    this.streamWs.send(JSON.stringify({
                        type: 'affiliate_click',
                        product: productName,
                        user: 'stream_viewer'
                    }));
                }
                
                this.addToOutput(`🛒 Opening ${productName} purchase page...`, 'success-message');
                this.addStreamChat('Viewer', `clicked affiliate link: ${productName}`, '');
                
                // In production, would open actual affiliate link
                // window.open(affiliateLink, '_blank');
            }
            
            toggleEmacsMode(enable) {
                this.emacsMode = enable;
                const indicator = document.getElementById('emacsMode');
                
                if (enable) {
                    indicator.classList.add('active');
                } else {
                    indicator.classList.remove('active');
                }
            }
            
            updateConnectionStatus(connected) {
                const output = document.getElementById('terminalOutput');
                if (connected) {
                    output.style.borderColor = '#00ff41';
                } else {
                    output.style.borderColor = '#ff4444';
                }
            }
            
            startStatsUpdates() {
                setInterval(() => {
                    // Update player count
                    document.getElementById('playerCount').textContent = `${Math.floor(Math.random() * 10) + 1} players`;
                    document.getElementById('sidebarPlayers').textContent = Math.floor(Math.random() * 10) + 1;
                    
                    // Update viewer count
                    const viewers = Math.floor(Math.random() * 45) + 15;
                    document.getElementById('viewerCount').textContent = `${viewers} viewers`;
                    document.getElementById('sidebarViewers').textContent = viewers;
                    
                    // Calculate revenue per hour
                    const runtime = (Date.now() - this.startTime) / 1000 / 3600;
                    const totalRevenue = parseFloat(document.getElementById('totalRevenue').textContent) || 0;
                    const revenuePerHour = runtime > 0 ? (totalRevenue / runtime).toFixed(2) : '0.00';
                    document.getElementById('revenuePerHour').textContent = `$${revenuePerHour}`;
                    
                }, 10000); // Update every 10 seconds
            }
            
            startDemoMode() {
                this.addToOutput('🎮 Demo mode activated - try these commands:', 'system-message');
                this.addToOutput('- move north/south/east/west', 'system-message');
                this.addToOutput('- talk cal_ai', 'system-message');  
                this.addToOutput('- revenue', 'system-message');
                this.addToOutput('- emacs M-x git-wrap', 'system-message');
                
                // Mock some activity for demo
                setTimeout(() => {
                    this.addToOutput('🤖 *Cal AI materializes from the digital ether*', 'cal-response');
                    this.addToOutput('Oh look, another human who thinks they can code...', 'cal-response');
                }, 3000);
            }
            
            handleDemoCommand(command) {
                const responses = {
                    'help': '🎮 Commands: move <dir>, talk <npc>, revenue, emacs <cmd>, buy <item>',
                    'look': '🏛️ The Revenue Hub\nA monetized paradise where Cal AI roams freely.',
                    'revenue': '💰 Total Revenue: $42.50 (Demo Mode)\n🎬 Stream: $30.00\n🎮 MUD: $12.50',
                    'talk cal_ai': '🤖 Cal AI: "Demo mode? How... predictable. Try the real thing!"',
                    'move north': '🚪 You move north to Cal\'s Roasting Chamber.',
                    'emacs': '⌨️ Emacs mode activated! Try C-x C-s or M-x git-wrap'
                };
                
                const response = responses[command] || `❓ Unknown command: ${command}`;
                setTimeout(() => {
                    this.addToOutput(response, 'system-message');
                }, 500);
            }
        }
        
        // Initialize the interface when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new MUDInterface();
        });
    </script>
</body>
</html>