<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé¨ Conversation to GIF Generator - FinishThisIdea Platform</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }
        
        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header .tagline {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }
        
        .nav-bar {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
            backdrop-filter: blur(10px);
        }
        
        .nav-bar a {
            color: white;
            text-decoration: none;
            margin: 0 15px;
            padding: 8px 16px;
            border-radius: 5px;
            transition: background 0.3s ease;
        }
        
        .nav-bar a:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .status-bar {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 30px;
            color: white;
            text-align: center;
            backdrop-filter: blur(10px);
        }
        
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .panel {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        
        .panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }
        
        .panel h3 {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .conversation-input {
            width: 100%;
            height: 300px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9rem;
            resize: vertical;
            margin-bottom: 20px;
            transition: border-color 0.3s ease;
        }
        
        .conversation-input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .control-group {
            margin-bottom: 20px;
        }
        
        .control-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }
        
        .control-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        select, input[type="number"], input[type="range"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 0.9rem;
        }
        
        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            text-decoration: none;
            display: inline-block;
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5a6fd8;
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .processing-status {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            display: none;
        }
        
        .processing-status.show {
            display: block;
        }
        
        .results-section {
            grid-column: 1 / -1;
        }
        
        .visual-elements {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .element-category {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .element-category h5 {
            margin-bottom: 10px;
            color: #333;
            font-size: 1rem;
        }
        
        .element-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }
        
        .tag {
            background: #667eea;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
        }
        
        .gif-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .gif-card {
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s ease;
        }
        
        .gif-card:hover {
            transform: translateY(-3px);
        }
        
        .gif-preview {
            width: 100%;
            height: 150px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .gif-preview img {
            max-width: 100%;
            max-height: 100%;
            border-radius: 8px;
        }
        
        .gif-info h4 {
            margin-bottom: 8px;
            color: #333;
        }
        
        .gif-meta {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 15px;
        }
        
        .websocket-status {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            z-index: 1000;
        }
        
        .websocket-status.connected {
            background: rgba(40, 167, 69, 0.8);
        }
        
        .websocket-status.disconnected {
            background: rgba(220, 53, 69, 0.8);
        }
        
        .log-panel {
            background: #1e1e1e;
            color: #ffffff;
            border-radius: 8px;
            padding: 15px;
            height: 200px;
            overflow-y: auto;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.8rem;
            margin-top: 20px;
        }
        
        .log-entry {
            margin-bottom: 5px;
            padding: 2px 0;
        }
        
        .log-entry.info { color: #17a2b8; }
        .log-entry.success { color: #28a745; }
        .log-entry.warning { color: #ffc107; }
        .log-entry.error { color: #dc3545; }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            margin: 15px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .control-row {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="websocket-status" id="ws-status">üîå Connecting...</div>
    
    <div class="container">
        <div class="header">
            <h1>üé¨ Conversation to GIF Generator</h1>
            <div class="tagline">Transform conversations into animated visuals with AI-powered analysis</div>
        </div>

        <div class="nav-bar">
            <a href="/platform-hub.html">üè† Platform Hub</a>
            <a href="#input-section">üìù Input</a>
            <a href="#results-section">üé® Results</a>
            <a href="/API-CONVERSATION-TO-GIF-GUIDE.md" target="_blank">üìñ API Docs</a>
            <a href="/chat/ai-chat.html">ü§ñ AI Chat</a>
        </div>

        <div class="status-bar">
            <strong>Pipeline Status:</strong> <span id="pipeline-status">‚è≥ Ready</span>
            | <strong>Active Generations:</strong> <span id="active-generations">0</span>
            | <strong>Total GIFs:</strong> <span id="total-gifs">0</span>
            | <strong>Processing Time:</strong> <span id="processing-time">0ms</span>
        </div>

        <div class="main-grid">
            <!-- Input Panel -->
            <div class="panel" id="input-section">
                <h3>üìù Conversation Input</h3>
                
                <div class="control-group">
                    <label for="conversation-input">Paste your conversation (JSON format):</label>
                    <textarea id="conversation-input" class="conversation-input" placeholder='[
  {"role": "user", "content": "I want to build a space game with rockets and aliens"},
  {"role": "assistant", "content": "Great idea! We could have flying rockets..."},
  {"role": "user", "content": "And maybe some bouncing asteroids too!"}
]'></textarea>
                </div>

                <div class="control-group">
                    <label>Animation Settings:</label>
                    <div class="control-row">
                        <div>
                            <label for="animation-type">Animation Type:</label>
                            <select id="animation-type">
                                <option value="bounce">üèÄ Bounce</option>
                                <option value="rotation">üîÑ Rotation</option>
                                <option value="pulse">üíì Pulse</option>
                                <option value="sequence">üé¨ Sequence</option>
                                <option value="loop" selected>üîÅ Loop</option>
                            </select>
                        </div>
                        <div>
                            <label for="sprite-size">Sprite Size:</label>
                            <select id="sprite-size">
                                <option value="16x16">16x16 (Tiny)</option>
                                <option value="32x32" selected>32x32 (Standard)</option>
                                <option value="64x64">64x64 (Large)</option>
                                <option value="128x128">128x128 (Detailed)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="control-row">
                        <div>
                            <label for="frame-count">Frames: <span id="frame-count-display">6</span></label>
                            <input type="range" id="frame-count" min="3" max="12" value="6" 
                                   oninput="document.getElementById('frame-count-display').textContent = this.value">
                        </div>
                        <div>
                            <label for="frame-delay">Frame Delay: <span id="frame-delay-display">250</span>ms</label>
                            <input type="range" id="frame-delay" min="100" max="1000" value="250" step="50"
                                   oninput="document.getElementById('frame-delay-display').textContent = this.value">
                        </div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="processConversation()" id="process-btn">
                        üé¨ Generate GIFs
                    </button>
                    <button class="btn btn-secondary" onclick="loadSampleConversation()">
                        üìÑ Load Sample
                    </button>
                </div>

                <div class="processing-status" id="processing-status">
                    <div>üîÑ Processing conversation...</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <div id="current-step">Analyzing conversation...</div>
                </div>
            </div>

            <!-- Control Panel -->
            <div class="panel">
                <h3>‚öôÔ∏è Pipeline Control</h3>
                
                <div class="control-group">
                    <label>Service Status:</label>
                    <div id="service-status">
                        <div class="service-status-item">
                            <span>üîç Visual Extractor:</span> <span id="extractor-status">Checking...</span>
                        </div>
                        <div class="service-status-item">
                            <span>üé® SoulFra Integration:</span> <span id="soulfra-status">Checking...</span>
                        </div>
                        <div class="service-status-item">
                            <span>üé¨ GIF Generator:</span> <span id="gif-status">Checking...</span>
                        </div>
                        <div class="service-status-item">
                            <span>ü§ñ AI Orchestrator:</span> <span id="ai-status">Checking...</span>
                        </div>
                    </div>
                </div>

                <div class="control-group">
                    <label>Extraction Options:</label>
                    <div style="display: grid; gap: 10px;">
                        <label><input type="checkbox" id="include-emotions" checked> Include Emotions</label>
                        <label><input type="checkbox" id="include-actions" checked> Include Actions</label>
                        <label><input type="checkbox" id="include-objects" checked> Include Objects</label>
                        <label><input type="checkbox" id="include-settings" checked> Include Settings</label>
                    </div>
                </div>

                <div class="control-group">
                    <label for="max-sprites">Max Sprites: <span id="max-sprites-display">5</span></label>
                    <input type="range" id="max-sprites" min="1" max="10" value="5"
                           oninput="document.getElementById('max-sprites-display').textContent = this.value">
                </div>

                <div class="log-panel" id="log-panel">
                    <div class="log-entry info">[INFO] Conversation-to-GIF pipeline ready</div>
                    <div class="log-entry info">[INFO] WebSocket connections initializing...</div>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div class="panel results-section" id="results-section">
            <h3>üé® Generated Results</h3>
            
            <div id="visual-elements-section" style="display: none;">
                <h4 style="margin-bottom: 15px;">üìä Extracted Visual Elements</h4>
                <div class="visual-elements" id="visual-elements"></div>
            </div>

            <div id="gif-gallery-section">
                <h4 style="margin-bottom: 15px;">üé¨ Generated GIFs</h4>
                <div class="gif-gallery" id="gif-gallery">
                    <div style="grid-column: 1 / -1; text-align: center; color: #666; padding: 60px 20px;">
                        <div style="font-size: 4rem; margin-bottom: 20px;">üé¨</div>
                        <p>Process a conversation to generate animated GIFs!</p>
                        <p style="font-size: 0.9rem; margin-top: 10px;">Your generated GIFs will appear here with download links.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // WebSocket connections
        let conversationWS = null;
        let gifWS = null;
        let soulFraWS = null;
        let mainWS = null;
        
        // State tracking
        let currentExtraction = null;
        let generatedGIFs = [];
        let processingStart = null;

        // Initialize all connections
        function initializeConnections() {
            // Main platform WebSocket
            try {
                mainWS = new WebSocket('ws://localhost:8081');
                mainWS.onopen = () => updateConnectionStatus('main', true);
                mainWS.onclose = () => updateConnectionStatus('main', false);
            } catch (error) {
                console.warn('Main WebSocket failed:', error);
            }

            // Conversation analysis WebSocket  
            try {
                conversationWS = new WebSocket('ws://localhost:8091/conversation-analysis');
                
                conversationWS.onopen = () => {
                    updateConnectionStatus('extractor', true);
                    addLog('Connected to conversation analyzer', 'success');
                };
                
                conversationWS.onmessage = (event) => {
                    const data = JSON.parse(event.data);
                    handleConversationMessage(data);
                };
                
                conversationWS.onclose = () => {
                    updateConnectionStatus('extractor', false);
                    addLog('Conversation analyzer disconnected', 'warning');
                };
                
            } catch (error) {
                updateConnectionStatus('extractor', false);
                addLog('Failed to connect to conversation analyzer', 'error');
            }

            // SoulFra integration WebSocket
            try {
                soulFraWS = new WebSocket('ws://localhost:8092');
                
                soulFraWS.onopen = () => {
                    updateConnectionStatus('soulfra', true);
                    addLog('Connected to SoulFra integration', 'success');
                };
                
                soulFraWS.onclose = () => updateConnectionStatus('soulfra', false);
                
            } catch (error) {
                updateConnectionStatus('soulfra', false);
            }

            // GIF generation WebSocket
            try {
                gifWS = new WebSocket('ws://localhost:8093');
                
                gifWS.onopen = () => {
                    updateConnectionStatus('gif', true);
                    addLog('Connected to GIF generator', 'success');
                };
                
                gifWS.onmessage = (event) => {
                    const data = JSON.parse(event.data);
                    handleGIFMessage(data);
                };
                
                gifWS.onclose = () => updateConnectionStatus('gif', false);
                
            } catch (error) {
                updateConnectionStatus('gif', false);
            }

            // Check AI orchestrator via HTTP
            checkAIOrchestrator();
        }

        function updateConnectionStatus(service, connected) {
            const statusMap = {
                'main': 'ws-status',
                'extractor': 'extractor-status', 
                'soulfra': 'soulfra-status',
                'gif': 'gif-status',
                'ai': 'ai-status'
            };
            
            const element = document.getElementById(statusMap[service]);
            if (element) {
                element.textContent = connected ? 'üü¢ Connected' : 'üî¥ Disconnected';
                element.style.color = connected ? '#28a745' : '#dc3545';
            }
            
            // Update main WebSocket status indicator
            if (service === 'main') {
                const wsStatus = document.getElementById('ws-status');
                wsStatus.textContent = connected ? 'üîå Connected' : 'üîå Disconnected';
                wsStatus.className = `websocket-status ${connected ? 'connected' : 'disconnected'}`;
            }
        }

        async function checkAIOrchestrator() {
            try {
                const response = await fetch('http://localhost:3001/health');
                const result = await response.json();
                updateConnectionStatus('ai', response.ok);
                addLog(`AI Orchestrator: ${result.status || 'healthy'}`, 'info');
            } catch (error) {
                updateConnectionStatus('ai', false);
                addLog('AI Orchestrator: offline', 'warning');
            }
        }

        function handleConversationMessage(data) {
            switch (data.type) {
                case 'visual_elements_found':
                    addLog(`Found visual elements: ${data.elements.objects?.join(', ')}`, 'info');
                    updateProgress(30);
                    updateCurrentStep('Generating sprite descriptions...');
                    break;
                    
                case 'sprite_description_ready':
                    addLog(`Sprite ready: ${data.sprite.name}`, 'success');
                    generateGIFFromSprite(data.sprite);
                    break;
                    
                case 'analysis_complete':
                    currentExtraction = data;
                    displayVisualElements(data.visualElements);
                    updateProgress(60);
                    updateCurrentStep('Generating GIFs from sprites...');
                    addLog(`Analysis complete: ${data.spriteDescriptions.length} sprites found`, 'success');
                    
                    // Generate GIFs for each sprite
                    data.spriteDescriptions.forEach(sprite => generateGIFFromSprite(sprite));
                    break;
            }
        }

        function handleGIFMessage(data) {
            switch (data.type) {
                case 'gif_generated':
                    addLog(`GIF generated: ${data.data.spriteData.name}`, 'success');
                    addGeneratedGIF(data.data);
                    updateProgress(80 + (generatedGIFs.length * 5));
                    
                    // Check if all GIFs are complete
                    if (currentExtraction && generatedGIFs.length >= currentExtraction.spriteDescriptions.length) {
                        completeGeneration();
                    }
                    break;
                    
                case 'generation_error':
                    addLog(`GIF generation failed: ${data.error}`, 'error');
                    break;
            }
        }

        function processConversation() {
            const input = document.getElementById('conversation-input').value.trim();
            
            if (!input) {
                addLog('Please enter a conversation', 'error');
                return;
            }
            
            try {
                const conversation = JSON.parse(input);
                
                if (!Array.isArray(conversation) || conversation.length === 0) {
                    addLog('Please enter a valid conversation array', 'error');
                    return;
                }
                
                startProcessing();
                
                const options = {
                    includeEmotions: document.getElementById('include-emotions').checked,
                    includeActions: document.getElementById('include-actions').checked,
                    includeObjects: document.getElementById('include-objects').checked,
                    includeSettings: document.getElementById('include-settings').checked,
                    maxSprites: parseInt(document.getElementById('max-sprites').value)
                };
                
                addLog(`Processing ${conversation.length} messages...`, 'info');
                
                if (conversationWS && conversationWS.readyState === WebSocket.OPEN) {
                    conversationWS.send(JSON.stringify({
                        type: 'analyze_conversation',
                        data: {
                            conversation: conversation,
                            options: options
                        }
                    }));
                } else {
                    addLog('Conversation analyzer not connected', 'error');
                    stopProcessing();
                }
                
            } catch (error) {
                addLog(`Invalid JSON format: ${error.message}`, 'error');
            }
        }

        function generateGIFFromSprite(spriteData) {
            if (!gifWS || gifWS.readyState !== WebSocket.OPEN) {
                addLog('GIF generator not connected', 'error');
                return;
            }
            
            const animationData = {
                type: document.getElementById('animation-type').value,
                frames: parseInt(document.getElementById('frame-count').value),
                duration: parseInt(document.getElementById('frame-delay').value) * parseInt(document.getElementById('frame-count').value),
                frameDelay: parseInt(document.getElementById('frame-delay').value)
            };
            
            // Override sprite size if specified
            spriteData.size = document.getElementById('sprite-size').value;
            
            gifWS.send(JSON.stringify({
                type: 'generate_gif',
                data: {
                    spriteData: spriteData,
                    animationData: animationData,
                    options: {
                        conversation: currentExtraction?.conversation || null
                    }
                }
            }));
        }

        function startProcessing() {
            processingStart = Date.now();
            generatedGIFs = [];
            currentExtraction = null;
            
            document.getElementById('processing-status').classList.add('show');
            document.getElementById('process-btn').disabled = true;
            document.getElementById('process-btn').textContent = 'üîÑ Processing...';
            document.getElementById('pipeline-status').textContent = 'üîÑ Processing';
            document.getElementById('gif-gallery').innerHTML = '';
            document.getElementById('visual-elements-section').style.display = 'none';
            
            updateProgress(10);
            updateCurrentStep('Analyzing conversation...');
        }

        function stopProcessing() {
            document.getElementById('processing-status').classList.remove('show');
            document.getElementById('process-btn').disabled = false;
            document.getElementById('process-btn').textContent = 'üé¨ Generate GIFs';
            updateProgress(0);
        }

        function completeGeneration() {
            const duration = Date.now() - processingStart;
            
            stopProcessing();
            document.getElementById('pipeline-status').textContent = '‚úÖ Complete';
            document.getElementById('processing-time').textContent = `${duration}ms`;
            document.getElementById('total-gifs').textContent = generatedGIFs.length;
            
            addLog(`Generation complete! ${generatedGIFs.length} GIFs created in ${duration}ms`, 'success');
        }

        function updateProgress(percent) {
            document.getElementById('progress-fill').style.width = `${percent}%`;
        }

        function updateCurrentStep(step) {
            document.getElementById('current-step').textContent = step;
        }

        function displayVisualElements(elements) {
            const container = document.getElementById('visual-elements');
            container.innerHTML = '';
            
            Object.entries(elements).forEach(([category, items]) => {
                if (items && items.length > 0) {
                    const categoryDiv = document.createElement('div');
                    categoryDiv.className = 'element-category';
                    
                    categoryDiv.innerHTML = `
                        <h5>${category.charAt(0).toUpperCase() + category.slice(1)}</h5>
                        <div class="element-tags">
                            ${items.map(item => `<span class="tag">${item}</span>`).join('')}
                        </div>
                    `;
                    
                    container.appendChild(categoryDiv);
                }
            });
            
            document.getElementById('visual-elements-section').style.display = 'block';
        }

        function addGeneratedGIF(gifData) {
            generatedGIFs.push(gifData);
            
            const gallery = document.getElementById('gif-gallery');
            
            // Clear placeholder if this is the first GIF
            if (generatedGIFs.length === 1) {
                gallery.innerHTML = '';
            }
            
            const gifCard = document.createElement('div');
            gifCard.className = 'gif-card';
            
            gifCard.innerHTML = `
                <div class="gif-preview">
                    <img src="http://localhost:8093${gifData.gifPath}" alt="${gifData.spriteData.name}" 
                         onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI2Y4ZjlmYSIvPjx0ZXh0IHg9IjUwIiB5PSI1MCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiM2NjYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5Mb2FkaW5nLi4uPC90ZXh0Pjwvc3ZnPg=='">
                </div>
                <div class="gif-info">
                    <h4>${gifData.spriteData.name}</h4>
                    <div class="gif-meta">
                        ${gifData.frameCount} frames ‚Ä¢ ${gifData.processingTime}ms
                        <br>Size: ${gifData.spriteData.size} ‚Ä¢ ${gifData.animationData.type}
                    </div>
                    <a href="http://localhost:8093${gifData.gifPath}" download="${gifData.spriteData.name}.gif" class="btn btn-primary" style="font-size: 0.8rem; padding: 8px 12px;">
                        üì• Download GIF
                    </a>
                </div>
            `;
            
            gallery.appendChild(gifCard);
            
            // Update active generations counter
            document.getElementById('active-generations').textContent = generatedGIFs.length;
        }

        function loadSampleConversation() {
            const sampleConversation = [
                {"role": "user", "content": "I want to build a space exploration game"},
                {"role": "assistant", "content": "That sounds exciting! What kind of space game are you thinking about?"},
                {"role": "user", "content": "Maybe with rockets that can fly around and aliens to encounter"},
                {"role": "assistant", "content": "Great! We could have different types of rockets and alien species. What about planets to explore?"},
                {"role": "user", "content": "Yes! And maybe some asteroids that bounce around the screen"},
                {"role": "assistant", "content": "Perfect! Bouncing asteroids would add some dynamic movement. We could also add some colorful space effects."}
            ];
            
            document.getElementById('conversation-input').value = JSON.stringify(sampleConversation, null, 2);
            addLog('Sample conversation loaded', 'info');
        }

        function addLog(message, type = 'info') {
            const logPanel = document.getElementById('log-panel');
            const timestamp = new Date().toLocaleTimeString();
            
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry ${type}`;
            logEntry.textContent = `[${timestamp}] ${message}`;
            
            logPanel.appendChild(logEntry);
            logPanel.scrollTop = logPanel.scrollHeight;
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeConnections();
            loadSampleConversation();
            
            // Refresh service status every 30 seconds
            setInterval(() => {
                checkAIOrchestrator();
            }, 30000);
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch (e.key) {
                    case 'Enter':
                        e.preventDefault();
                        processConversation();
                        break;
                    case 'l':
                        e.preventDefault();
                        loadSampleConversation();
                        break;
                }
            }
        });
    </script>
</body>
</html>