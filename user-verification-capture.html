<!DOCTYPE html>
<html>
<head>
    <title>üîê User Verification Capture - Launch Confirmation</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #000;
            color: #0f0;
            font-family: 'Courier New', monospace;
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            border: 2px solid #0f0;
            padding: 30px;
            border-radius: 10px;
            background: rgba(0, 255, 0, 0.05);
        }
        
        .header {
            text-align: center;
            font-size: 24px;
            margin-bottom: 30px;
            text-shadow: 0 0 10px #0f0;
        }
        
        .verification-section {
            border: 1px solid #0f0;
            margin: 20px 0;
            padding: 20px;
            border-radius: 5px;
        }
        
        .verification-section h3 {
            color: #ff0;
            margin-top: 0;
        }
        
        .capture-button {
            background: rgba(0, 255, 0, 0.2);
            border: 2px solid #0f0;
            color: #0f0;
            padding: 15px 30px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
            border-radius: 5px;
            transition: all 0.3s;
        }
        
        .capture-button:hover {
            background: rgba(0, 255, 0, 0.4);
            box-shadow: 0 0 15px #0f0;
        }
        
        .capture-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .preview-area {
            border: 1px dashed #0f0;
            padding: 20px;
            margin: 15px 0;
            text-align: center;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        
        .preview-item {
            margin: 10px;
            max-width: 100%;
        }
        
        .preview-item img {
            max-width: 300px;
            max-height: 200px;
            border: 1px solid #0f0;
        }
        
        .preview-item video {
            max-width: 300px;
            border: 1px solid #0f0;
        }
        
        .verification-status {
            background: rgba(0, 255, 0, 0.1);
            border-left: 4px solid #0f0;
            padding: 10px 15px;
            margin: 15px 0;
        }
        
        .verification-complete {
            background: rgba(0, 255, 0, 0.2);
            border-color: #0f0;
        }
        
        .signature-pad {
            border: 1px solid #0f0;
            background: #111;
            cursor: crosshair;
        }
        
        .final-verification {
            background: rgba(255, 255, 0, 0.1);
            border: 2px solid #ff0;
            padding: 25px;
            margin-top: 30px;
            text-align: center;
        }
        
        .confirm-button {
            background: rgba(255, 255, 0, 0.3);
            border: 2px solid #ff0;
            color: #ff0;
            padding: 20px 40px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            border-radius: 5px;
            margin: 20px;
        }
        
        .confirm-button:hover {
            background: rgba(255, 255, 0, 0.5);
            box-shadow: 0 0 20px #ff0;
        }
        
        .timestamp {
            color: #0ff;
            font-size: 12px;
            margin-top: 10px;
        }
        
        .verification-log {
            background: #111;
            border: 1px solid #0f0;
            padding: 15px;
            margin: 20px 0;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .log-entry {
            margin: 5px 0;
            color: #0ff;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            üîê USER VERIFICATION CAPTURE
            <div style="font-size: 16px; color: #0ff; margin-top: 10px;">
                Launch ID: LAUNCH-1753225781953 | Verification Required
            </div>
        </div>

        <!-- Camera/Visual Verification -->
        <div class="verification-section">
            <h3>üì∑ Visual Verification</h3>
            <p>Capture visual proof of launch confirmation via camera or screenshot</p>
            
            <button class="capture-button" onclick="startCamera()">üìπ Start Camera</button>
            <button class="capture-button" onclick="captureScreenshot()">üì∏ Capture Screenshot</button>
            <button class="capture-button" onclick="capturePhoto()" id="photoBtn" disabled>üì∑ Take Photo</button>
            
            <div class="preview-area" id="visualPreview">
                <div>Visual verification will appear here</div>
                <video id="cameraFeed" style="display: none;" autoplay muted></video>
                <canvas id="photoCanvas" style="display: none;"></canvas>
            </div>
            
            <div class="verification-status" id="visualStatus">
                Status: Waiting for visual verification...
            </div>
        </div>

        <!-- Audio Verification -->
        <div class="verification-section">
            <h3>üé§ Audio Verification</h3>
            <p>Record audio confirmation of launch approval</p>
            
            <button class="capture-button" onclick="startRecording()" id="recordBtn">üéôÔ∏è Start Recording</button>
            <button class="capture-button" onclick="stopRecording()" id="stopBtn" disabled>‚èπÔ∏è Stop Recording</button>
            <button class="capture-button" onclick="playRecording()" id="playBtn" disabled>‚ñ∂Ô∏è Play Recording</button>
            
            <div class="preview-area" id="audioPreview">
                <div>Audio verification will appear here</div>
                <audio id="audioPlayback" controls style="display: none;"></audio>
            </div>
            
            <div class="verification-status" id="audioStatus">
                Status: Waiting for audio verification...
            </div>
        </div>

        <!-- Digital Signature -->
        <div class="verification-section">
            <h3>‚úçÔ∏è Digital Signature</h3>
            <p>Provide digital signature confirmation</p>
            
            <canvas id="signaturePad" class="signature-pad" width="400" height="150"></canvas>
            <br>
            <button class="capture-button" onclick="clearSignature()">üóëÔ∏è Clear</button>
            <button class="capture-button" onclick="saveSignature()">üíæ Save Signature</button>
            
            <div class="verification-status" id="signatureStatus">
                Status: Waiting for digital signature...
            </div>
        </div>

        <!-- Biometric-style Verification -->
        <div class="verification-section">
            <h3>üî¢ Biometric-Style Verification</h3>
            <p>Confirm with unique pattern or sequence</p>
            
            <div style="margin: 20px 0;">
                <label>Enter confirmation phrase: </label>
                <input type="text" id="confirmPhrase" placeholder="I confirm this launch is verified" 
                       style="background: #111; border: 1px solid #0f0; color: #0f0; padding: 8px;">
            </div>
            
            <div style="margin: 20px 0;">
                <label>Mouse pattern (click to draw): </label>
                <canvas id="patternPad" width="300" height="100" style="border: 1px solid #0f0; background: #111; cursor: crosshair;"></canvas>
            </div>
            
            <button class="capture-button" onclick="verifyBiometric()">üîç Verify Pattern</button>
            
            <div class="verification-status" id="biometricStatus">
                Status: Waiting for biometric verification...
            </div>
        </div>

        <!-- Verification Log -->
        <div class="verification-section">
            <h3>üìã Verification Log</h3>
            <div class="verification-log" id="verificationLog">
                <div class="log-entry">System initialized - waiting for user verification...</div>
            </div>
        </div>

        <!-- Final Confirmation -->
        <div class="final-verification" id="finalSection" style="display: none;">
            <h2>üéØ FINAL LAUNCH CONFIRMATION</h2>
            <p>All verification methods completed. Ready to generate signed verification certificate.</p>
            
            <button class="confirm-button" onclick="generateVerificationCertificate()">
                üîê GENERATE SIGNED VERIFICATION CERTIFICATE
            </button>
            
            <div class="timestamp">
                Verification completed at: <span id="completionTime"></span>
            </div>
        </div>
    </div>

    <script>
        let mediaStream = null;
        let mediaRecorder = null;
        let audioChunks = [];
        let verificationData = {
            visual: null,
            audio: null,
            signature: null,
            biometric: null,
            timestamp: null
        };

        // Visual Verification
        async function startCamera() {
            try {
                mediaStream = await navigator.mediaDevices.getUserMedia({ 
                    video: { width: 640, height: 480 },
                    audio: false 
                });
                
                const video = document.getElementById('cameraFeed');
                video.srcObject = mediaStream;
                video.style.display = 'block';
                document.getElementById('photoBtn').disabled = false;
                
                logVerification('Camera started successfully');
                updateStatus('visualStatus', 'Camera active - ready to capture photo');
            } catch (error) {
                logVerification('Camera access denied or unavailable');
                updateStatus('visualStatus', 'Camera unavailable - use screenshot instead');
            }
        }

        function capturePhoto() {
            const video = document.getElementById('cameraFeed');
            const canvas = document.getElementById('photoCanvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            ctx.drawImage(video, 0, 0);
            
            canvas.style.display = 'block';
            verificationData.visual = canvas.toDataURL('image/png');
            
            logVerification('Photo captured successfully');
            updateStatus('visualStatus', 'Visual verification complete ‚úÖ', true);
            
            // Stop camera
            if (mediaStream) {
                mediaStream.getTracks().forEach(track => track.stop());
            }
            
            checkAllVerifications();
        }

        async function captureScreenshot() {
            try {
                const stream = await navigator.mediaDevices.getDisplayMedia({ video: true });
                const video = document.createElement('video');
                video.srcObject = stream;
                video.play();
                
                video.addEventListener('loadedmetadata', () => {
                    const canvas = document.createElement('canvas');
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(video, 0, 0);
                    
                    verificationData.visual = canvas.toDataURL('image/png');
                    
                    // Display preview
                    const img = document.createElement('img');
                    img.src = verificationData.visual;
                    img.style.maxWidth = '300px';
                    
                    const preview = document.getElementById('visualPreview');
                    preview.innerHTML = '';
                    preview.appendChild(img);
                    
                    logVerification('Screenshot captured successfully');
                    updateStatus('visualStatus', 'Visual verification complete ‚úÖ', true);
                    
                    // Stop screen capture
                    stream.getTracks().forEach(track => track.stop());
                    
                    checkAllVerifications();
                });
            } catch (error) {
                logVerification('Screenshot capture failed or denied');
                updateStatus('visualStatus', 'Screenshot unavailable');
            }
        }

        // Audio Verification
        async function startRecording() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                mediaRecorder = new MediaRecorder(stream);
                audioChunks = [];
                
                mediaRecorder.ondataavailable = (event) => {
                    audioChunks.push(event.data);
                };
                
                mediaRecorder.onstop = () => {
                    const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
                    const audioUrl = URL.createObjectURL(audioBlob);
                    
                    const audio = document.getElementById('audioPlayback');
                    audio.src = audioUrl;
                    audio.style.display = 'block';
                    
                    verificationData.audio = audioUrl;
                    
                    logVerification('Audio recording completed');
                    updateStatus('audioStatus', 'Audio verification complete ‚úÖ', true);
                    
                    document.getElementById('playBtn').disabled = false;
                    checkAllVerifications();
                };
                
                mediaRecorder.start();
                document.getElementById('recordBtn').disabled = true;
                document.getElementById('stopBtn').disabled = false;
                
                logVerification('Audio recording started');
                updateStatus('audioStatus', 'Recording audio...');
                
            } catch (error) {
                logVerification('Microphone access denied or unavailable');
                updateStatus('audioStatus', 'Microphone unavailable');
            }
        }

        function stopRecording() {
            if (mediaRecorder && mediaRecorder.state === 'recording') {
                mediaRecorder.stop();
                document.getElementById('recordBtn').disabled = false;
                document.getElementById('stopBtn').disabled = true;
            }
        }

        function playRecording() {
            const audio = document.getElementById('audioPlayback');
            audio.play();
        }

        // Digital Signature
        function setupSignaturePad() {
            const canvas = document.getElementById('signaturePad');
            const ctx = canvas.getContext('2d');
            let isDrawing = false;
            
            canvas.addEventListener('mousedown', (e) => {
                isDrawing = true;
                ctx.beginPath();
                ctx.moveTo(e.offsetX, e.offsetY);
            });
            
            canvas.addEventListener('mousemove', (e) => {
                if (isDrawing) {
                    ctx.lineTo(e.offsetX, e.offsetY);
                    ctx.strokeStyle = '#0f0';
                    ctx.lineWidth = 2;
                    ctx.stroke();
                }
            });
            
            canvas.addEventListener('mouseup', () => {
                isDrawing = false;
            });
        }

        function clearSignature() {
            const canvas = document.getElementById('signaturePad');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function saveSignature() {
            const canvas = document.getElementById('signaturePad');
            verificationData.signature = canvas.toDataURL('image/png');
            
            logVerification('Digital signature captured');
            updateStatus('signatureStatus', 'Digital signature complete ‚úÖ', true);
            
            checkAllVerifications();
        }

        // Biometric-style Verification
        function setupPatternPad() {
            const canvas = document.getElementById('patternPad');
            const ctx = canvas.getContext('2d');
            let points = [];
            
            canvas.addEventListener('click', (e) => {
                const x = e.offsetX;
                const y = e.offsetY;
                points.push({ x, y });
                
                // Draw point
                ctx.fillStyle = '#0f0';
                ctx.beginPath();
                ctx.arc(x, y, 3, 0, 2 * Math.PI);
                ctx.fill();
                
                // Connect lines
                if (points.length > 1) {
                    ctx.strokeStyle = '#0f0';
                    ctx.lineWidth = 1;
                    ctx.beginPath();
                    ctx.moveTo(points[points.length - 2].x, points[points.length - 2].y);
                    ctx.lineTo(x, y);
                    ctx.stroke();
                }
            });
        }

        function verifyBiometric() {
            const phrase = document.getElementById('confirmPhrase').value;
            const canvas = document.getElementById('patternPad');
            
            if (phrase.toLowerCase().includes('confirm') && phrase.toLowerCase().includes('launch')) {
                verificationData.biometric = {
                    phrase: phrase,
                    pattern: canvas.toDataURL('image/png'),
                    timestamp: Date.now()
                };
                
                logVerification('Biometric verification completed');
                updateStatus('biometricStatus', 'Biometric verification complete ‚úÖ', true);
                
                checkAllVerifications();
            } else {
                logVerification('Biometric verification failed - invalid phrase');
                updateStatus('biometricStatus', 'Invalid confirmation phrase');
            }
        }

        // Utility Functions
        function updateStatus(elementId, message, complete = false) {
            const element = document.getElementById(elementId);
            element.textContent = 'Status: ' + message;
            if (complete) {
                element.classList.add('verification-complete');
            }
        }

        function logVerification(message) {
            const log = document.getElementById('verificationLog');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        function checkAllVerifications() {
            const hasVisual = verificationData.visual !== null;
            const hasAudio = verificationData.audio !== null;
            const hasSignature = verificationData.signature !== null;
            const hasBiometric = verificationData.biometric !== null;
            
            if (hasVisual || hasAudio || hasSignature || hasBiometric) {
                // At least one verification method completed
                document.getElementById('finalSection').style.display = 'block';
                logVerification('Verification methods ready for final confirmation');
            }
        }

        function generateVerificationCertificate() {
            verificationData.timestamp = Date.now();
            
            const certificate = {
                launchId: 'LAUNCH-1753225781953',
                userId: 'matthewmauer',
                timestamp: new Date().toISOString(),
                verificationMethods: {
                    visual: verificationData.visual ? 'VERIFIED' : 'NOT_PROVIDED',
                    audio: verificationData.audio ? 'VERIFIED' : 'NOT_PROVIDED',
                    signature: verificationData.signature ? 'VERIFIED' : 'NOT_PROVIDED',
                    biometric: verificationData.biometric ? 'VERIFIED' : 'NOT_PROVIDED'
                },
                certificateHash: generateHash(),
                status: 'USER_VERIFIED_LAUNCH'
            };
            
            // Save certificate
            const certData = JSON.stringify(certificate, null, 2);
            downloadFile(certData, `launch-verification-certificate-${Date.now()}.json`);
            
            logVerification('VERIFICATION CERTIFICATE GENERATED');
            document.getElementById('completionTime').textContent = new Date().toISOString();
            
            alert('üéâ USER VERIFICATION COMPLETE!\n\nSigned verification certificate generated.\nLaunch is now fully documented with user proof.');
        }

        function generateHash() {
            return 'CERT-' + Math.random().toString(36).substring(2, 15) + '-' + Date.now();
        }

        function downloadFile(content, filename) {
            const blob = new Blob([content], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
        }

        // Initialize
        setupSignaturePad();
        setupPatternPad();
        logVerification('User verification system initialized');
    </script>
</body>
</html>