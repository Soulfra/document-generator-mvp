<!DOCTYPE html>
<html>
<head>
    <title>üî• UNIFIED EVERYTHING - One System That Works</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            color: #0f0;
            font-family: 'Courier New', monospace;
            overflow: hidden;
        }
        
        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 80px 1fr 200px;
            height: 100vh;
            gap: 10px;
            padding: 10px;
        }
        
        .header {
            grid-column: 1 / -1;
            background: rgba(0, 255, 0, 0.1);
            border: 2px solid #0f0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
        }
        
        .panel {
            background: rgba(0, 255, 0, 0.05);
            border: 1px solid #0f0;
            padding: 20px;
            overflow-y: auto;
        }
        
        .console {
            grid-column: 1 / -1;
            background: #111;
            border: 2px solid #0f0;
            padding: 10px;
            overflow-y: auto;
            font-size: 12px;
        }
        
        .status-dot {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 10px;
        }
        
        .online { background: #0f0; box-shadow: 0 0 10px #0f0; }
        .offline { background: #f00; }
        
        .btn {
            background: #0f0;
            color: #000;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
            transition: all 0.3s;
        }
        
        .btn:hover {
            box-shadow: 0 0 20px #0f0;
            transform: scale(1.1);
        }
        
        .data-item {
            margin: 10px 0;
            padding: 10px;
            background: rgba(0, 255, 0, 0.1);
            border-left: 3px solid #0f0;
        }
        
        .game-result {
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #0ff;
            background: rgba(0, 255, 255, 0.1);
        }
        
        h2 {
            color: #0ff;
            margin-top: 0;
        }
        
        .real-data {
            color: #ff0;
            font-weight: bold;
        }
        
        .count {
            font-size: 24px;
            color: #0ff;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üî• UNIFIED EVERYTHING</h1>
            <div>
                <span class="status-dot" id="statusDot"></span>
                <span id="statusText">Connecting...</span>
                <button class="btn" onclick="refreshEverything()">üîÑ REFRESH</button>
                <button class="btn" onclick="testGame()">üéÆ TEST GAME</button>
                <button class="btn" onclick="broadcastAll()">üì¢ BROADCAST</button>
            </div>
        </div>
        
        <div class="panel" id="leftPanel">
            <h2>üåê REAL DATA (Dynamic)</h2>
            <div id="realDataContent">Loading...</div>
        </div>
        
        <div class="panel" id="rightPanel">
            <h2>üéÆ GAMING & WORLDS</h2>
            <div id="gamingContent">Loading...</div>
        </div>
        
        <div class="console" id="console">
            <div style="color: #0ff;">[SYSTEM] Unified interface initialized</div>
        </div>
    </div>

    <script>
        let unifiedData = {};
        let isOnline = false;

        async function init() {
            log('[INIT] Starting unified system interface', '#0ff');
            
            // Initial load
            await refreshEverything();
            
            // Auto refresh every 5 seconds
            setInterval(refreshEverything, 5000);
        }

        async function refreshEverything() {
            try {
                // Get everything from unified API
                const response = await fetch('http://localhost:4000/api/everything');
                
                if (!response.ok) throw new Error('API offline');
                
                unifiedData = await response.json();
                
                updateStatus(true);
                updateRealData();
                updateGaming();
                
                log('[UPDATE] All systems synchronized', '#0f0');
                
            } catch (error) {
                updateStatus(false);
                log(`[ERROR] ${error.message}`, '#f00');
            }
        }

        function updateStatus(online) {
            isOnline = online;
            const dot = document.getElementById('statusDot');
            const text = document.getElementById('statusText');
            
            if (online) {
                dot.className = 'status-dot online';
                text.textContent = 'ALL SYSTEMS OPERATIONAL';
                text.style.color = '#0f0';
            } else {
                dot.className = 'status-dot offline';
                text.textContent = 'SYSTEMS OFFLINE';
                text.style.color = '#f00';
            }
        }

        function updateRealData() {
            const container = document.getElementById('realDataContent');
            
            if (!unifiedData.universal?.data) {
                container.innerHTML = '<div>No data available</div>';
                return;
            }
            
            const data = unifiedData.universal.data;
            let html = '';
            
            // Wikipedia data
            if (data.wikipedia) {
                html += `
                    <div class="data-item">
                        <strong>üìö Wikipedia:</strong> ${data.wikipedia.title}<br>
                        <small>${data.wikipedia.extract.substring(0, 100)}...</small><br>
                        <span class="real-data">Views: ${data.wikipedia.views}</span>
                    </div>
                `;
            }
            
            // GitHub data
            if (data.github) {
                html += `
                    <div class="data-item">
                        <strong>üêô GitHub:</strong> ${data.github.repo}<br>
                        <span class="real-data">‚≠ê ${data.github.stars.toLocaleString()} stars</span><br>
                        <span class="real-data">üç¥ ${data.github.forks.toLocaleString()} forks</span>
                    </div>
                `;
            }
            
            // W3C data
            if (data.w3c) {
                html += `
                    <div class="data-item">
                        <strong>üîó W3C Standards:</strong><br>
                        Validators: ${data.w3c.availableStandards.validationTools.length}<br>
                        Protocols: ${data.w3c.availableStandards.protocols.length}<br>
                        <span class="real-data">Auth Ready: ${data.w3c.authenticationReady ? '‚úÖ' : '‚ùå'}</span>
                    </div>
                `;
            }
            
            // Financial data
            if (unifiedData.financial) {
                html += `
                    <div class="data-item">
                        <strong>üí∞ Financial:</strong><br>
                        Revenue: <span class="real-data">$${(unifiedData.financial.actualRevenue || 0).toFixed(2)}</span><br>
                        Trades: <span class="real-data">${unifiedData.financial.realTrades || 0}</span><br>
                        API Costs: <span class="real-data">$${(unifiedData.financial.realApiCosts || 0).toFixed(4)}</span>
                    </div>
                `;
            }
            
            // Pairings
            if (unifiedData.pairings) {
                const pairingCount = Object.keys(unifiedData.pairings).filter(k => unifiedData.pairings[k]?.paired).length;
                html += `
                    <div class="data-item">
                        <strong>üîó Dynamic Pairings:</strong> <span class="count">${pairingCount}</span><br>
                        ${Object.keys(unifiedData.pairings).map(k => k.replace(/_/g, ' ‚Üî ')).join('<br>')}
                    </div>
                `;
            }
            
            container.innerHTML = html;
        }

        function updateGaming() {
            const container = document.getElementById('gamingContent');
            
            if (!unifiedData.gaming) {
                container.innerHTML = '<div>No gaming data available</div>';
                return;
            }
            
            const gaming = unifiedData.gaming;
            let html = '';
            
            // Gaming stats
            html += `
                <div class="data-item">
                    <strong>üéÆ Gaming Engines:</strong> ${gaming.activeGameEngines}/${gaming.totalGameEngines}<br>
                    <strong>üë• Active Players:</strong> ${gaming.activePlayers}<br>
                    <strong>üéØ Total Sessions:</strong> ${gaming.totalSessions}
                </div>
            `;
            
            // Game engines
            if (gaming.gameEngines) {
                html += '<div class="data-item"><strong>Available Games:</strong><br>';
                gaming.gameEngines.forEach(game => {
                    html += `‚Ä¢ ${game.name} (${game.status})<br>`;
                });
                html += '</div>';
            }
            
            // Worlds
            if (unifiedData.worlds) {
                const worldCount = unifiedData.worlds.worlds?.length || 0;
                html += `
                    <div class="data-item">
                        <strong>üåç Discovered Worlds:</strong> <span class="count">${worldCount}</span><br>
                        ${unifiedData.worlds.categories ? `
                            ‚Ä¢ Worlds: ${unifiedData.worlds.categories.worlds}<br>
                            ‚Ä¢ Engines: ${unifiedData.worlds.categories.engines}<br>
                            ‚Ä¢ Games: ${unifiedData.worlds.categories.games}<br>
                            ‚Ä¢ Interfaces: ${unifiedData.worlds.categories.interfaces}
                        ` : ''}
                    </div>
                `;
            }
            
            container.innerHTML = html;
        }

        async function testGame() {
            try {
                log('[GAME] Testing game action...', '#ff0');
                
                const response = await fetch('http://localhost:4000/api/game/action', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        action: 'invest',
                        gameId: 'vcGame',
                        data: { amount: 1000, company: 'TestCorp' }
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    const gameHtml = `
                        <div class="game-result">
                            üí∞ Investment Result:<br>
                            Amount: $${result.result.investment}<br>
                            Outcome: ${result.result.outcome}<br>
                            Returns: $${result.result.returns}<br>
                            Profit: $${result.result.profit}
                        </div>
                    `;
                    
                    document.getElementById('gamingContent').insertAdjacentHTML('afterbegin', gameHtml);
                    log(`[GAME] Investment ${result.result.outcome}: $${result.result.profit} profit`, '#0ff');
                } else {
                    log('[GAME] Action failed', '#f00');
                }
                
            } catch (error) {
                log(`[GAME] Error: ${error.message}`, '#f00');
            }
        }

        async function broadcastAll() {
            try {
                const message = prompt('Enter broadcast message:');
                if (!message) return;
                
                const response = await fetch('http://localhost:4000/api/action', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        target: 'broadcast',
                        action: 'message',
                        data: { message, layer: 'all' }
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    log(`[BROADCAST] Message sent to ${result.recipients} recipients`, '#0f0');
                } else {
                    log('[BROADCAST] Failed to send', '#f00');
                }
                
            } catch (error) {
                log(`[BROADCAST] Error: ${error.message}`, '#f00');
            }
        }

        function log(message, color = '#0f0') {
            const console = document.getElementById('console');
            const entry = document.createElement('div');
            entry.style.color = color;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            console.appendChild(entry);
            console.scrollTop = console.scrollHeight;
            
            // Keep only last 50 entries
            while (console.children.length > 50) {
                console.removeChild(console.firstChild);
            }
        }

        // Initialize on load
        window.onload = init;
    </script>
</body>
</html>