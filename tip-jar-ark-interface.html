<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸº Tip Jar Ark - Noah's Vessel Interface</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            color: #e94560;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(0,0,0,0.8);
            border-radius: 15px;
            padding: 30px;
            border: 2px solid #e94560;
            box-shadow: 0 0 20px rgba(233, 69, 96, 0.3);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { text-shadow: 0 0 10px #e94560; }
            to { text-shadow: 0 0 20px #e94560, 0 0 30px #e94560; }
        }
        
        .ark-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .status-panel {
            background: rgba(233, 69, 96, 0.1);
            border: 1px solid #e94560;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }
        
        .user-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .user-panel {
            background: rgba(15, 52, 96, 0.3);
            border: 1px solid #0f3460;
            border-radius: 10px;
            padding: 20px;
        }
        
        .gamemaster-panel {
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid gold;
        }
        
        .unix-panel {
            background: rgba(0, 255, 0, 0.1);
            border: 1px solid lime;
        }
        
        .nonunix-panel {
            background: rgba(255, 0, 255, 0.1);
            border: 1px solid magenta;
        }
        
        .moderator-panel {
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid cyan;
        }
        
        button {
            background: #e94560;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-family: inherit;
            transition: all 0.3s;
        }
        
        button:hover {
            background: #ff6b7a;
            transform: scale(1.05);
        }
        
        button:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }
        
        .connection-status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
            font-weight: bold;
        }
        
        .connected { background: rgba(0, 255, 0, 0.2); color: lime; }
        .disconnected { background: rgba(255, 0, 0, 0.2); color: #ff6b7a; }
        .connecting { background: rgba(255, 255, 0, 0.2); color: yellow; }
        
        .log-panel {
            background: rgba(0,0,0,0.5);
            border: 1px solid #333;
            border-radius: 10px;
            padding: 20px;
            height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        
        .log-entry {
            margin: 5px 0;
            padding: 5px;
            border-left: 3px solid #e94560;
            padding-left: 10px;
        }
        
        .tip-jar-controls {
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid gold;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        
        select, input {
            background: #333;
            color: #e94560;
            border: 1px solid #e94560;
            padding: 5px;
            border-radius: 3px;
            font-family: inherit;
        }
        
        .circular-flow-display {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background: rgba(233, 69, 96, 0.1);
            border-radius: 10px;
            border: 1px solid #e94560;
        }
        
        .phase-indicator {
            font-size: 24px;
            margin: 10px 0;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 0.5; }
            50% { opacity: 1; }
            100% { opacity: 0.5; }
        }
        
        .ark-capacity {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }
        
        .capacity-bar {
            width: 100px;
            height: 20px;
            background: #333;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        
        .capacity-fill {
            height: 100%;
            transition: width 0.3s;
            border-radius: 10px;
        }
        
        .unix-fill { background: lime; }
        .nonunix-fill { background: magenta; }
        .gamemaster-fill { background: gold; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸº Tip Jar Ark - Noah's Vessel</h1>
            <p>âš“ 50 Unix Users + 3 Non-Unix + 1 Game Master</p>
            <p>ğŸŒ€ Everyone goes in circles between colors, theories, and reasoning</p>
        </div>
        
        <div class="ark-status">
            <div class="status-panel">
                <h3>ğŸš¢ Ark Status</h3>
                <div id="ark-status">Initializing...</div>
                <div class="ark-capacity">
                    <div>
                        <div>Unix: <span id="unix-count">0</span>/50</div>
                        <div class="capacity-bar">
                            <div class="capacity-fill unix-fill" id="unix-bar" style="width: 0%"></div>
                        </div>
                    </div>
                    <div>
                        <div>Non-Unix: <span id="nonunix-count">0</span>/3</div>
                        <div class="capacity-bar">
                            <div class="capacity-fill nonunix-fill" id="nonunix-bar" style="width: 0%"></div>
                        </div>
                    </div>
                    <div>
                        <div>Master: <span id="gamemaster-count">0</span>/1</div>
                        <div class="capacity-bar">
                            <div class="capacity-fill gamemaster-fill" id="gamemaster-bar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="status-panel">
                <h3>ğŸŒ€ Circular Flow</h3>
                <div class="circular-flow-display">
                    <div class="phase-indicator" id="current-phase">Colors</div>
                    <div id="current-element">Waiting...</div>
                    <div id="flow-direction">â¸ï¸ Stopped</div>
                    <div>Speed: <span id="flow-speed">1000</span>ms</div>
                </div>
            </div>
            
            <div class="status-panel">
                <h3>ğŸº Tip Jar</h3>
                <div id="tip-jar-status">
                    <div>Total Value: <span id="tip-total">0</span></div>
                    <div>Contributions: <span id="tip-count">0</span></div>
                </div>
            </div>
            
            <div class="status-panel">
                <h3>ğŸ¯ Hack Attempts</h3>
                <div id="hack-status">
                    <div>Total Attempts: <span id="hack-count">0</span></div>
                    <div>Success Rate: 0% (Game Master wins)</div>
                </div>
            </div>
        </div>
        
        <div class="user-controls">
            <div class="user-panel gamemaster-panel">
                <h3>ğŸ‘‘ Game Master Controls</h3>
                <div class="connection-status disconnected" id="gamemaster-status">
                    Disconnected
                </div>
                <button onclick="connectGameMaster()" id="gamemaster-connect">Connect as Game Master</button>
                <div id="gamemaster-controls" style="display: none;">
                    <button onclick="startCircles()">ğŸŒ€ Start Circles</button>
                    <button onclick="stopCircles()">â¸ï¸ Stop Circles</button>
                    <button onclick="changeDirection()">ğŸ”„ Change Direction</button>
                    <button onclick="adjustSpeed('faster')">âš¡ Faster</button>
                    <button onclick="adjustSpeed('slower')">ğŸŒ Slower</button>
                    <button onclick="forceHack()">ğŸ¯ Force Hack Attempt</button>
                    <button onclick="resetCircles()">ğŸ”„ Reset All</button>
                    <button onclick="collectTips()">ğŸº Collect Tips</button>
                </div>
            </div>
            
            <div class="user-panel unix-panel">
                <h3>ğŸ§ Unix User</h3>
                <div class="connection-status disconnected" id="unix-status">
                    Disconnected
                </div>
                <button onclick="connectUnixUser()" id="unix-connect">Connect as Unix User</button>
                <div id="unix-info" style="display: none;">
                    <p>You will be forced into circular flow!</p>
                    <p>Circle Position: <span id="unix-position">0</span></p>
                    <p>Hack Attempts: <span id="unix-hacks">0</span></p>
                    <button onclick="attemptHack()">ğŸ¯ Try to Hack Game Master</button>
                    <button onclick="reasonWithGameMaster()">ğŸ’­ Reason with Game Master</button>
                </div>
            </div>
            
            <div class="user-panel nonunix-panel">
                <h3>ğŸ–¥ï¸ Non-Unix User</h3>
                <div class="connection-status disconnected" id="nonunix-status">
                    Disconnected
                </div>
                <button onclick="connectNonUnixUser()" id="nonunix-connect">Connect as Non-Unix User</button>
                <div id="nonunix-info" style="display: none;">
                    <p>âœ¨ Special privileges granted!</p>
                    <p>Can see Game Master: <span id="can-see-gm">Yes</span></p>
                    <p>Can break circles: <span id="can-break">Maybe</span></p>
                    <button onclick="attemptBreakCircle()">ğŸ’¥ Try to Break Circle</button>
                    <button onclick="useSpecialPrivilege()">âœ¨ Use Special Privilege</button>
                </div>
            </div>
            
            <div class="user-panel moderator-panel">
                <h3>ğŸ‘¨â€ğŸ« Guardian/Teacher Moderator</h3>
                <div class="connection-status disconnected" id="moderator-status">
                    Disconnected
                </div>
                <button onclick="connectModerator()" id="moderator-connect">Connect as Moderator</button>
                <div id="moderator-controls" style="display: none;">
                    <button onclick="moderateAction('slow_circles')">ğŸŒ Slow Circles</button>
                    <button onclick="moderateAction('fast_circles')">âš¡ Fast Circles</button>
                    <button onclick="moderateAction('pause_circles')">â¸ï¸ Pause Circles</button>
                    <button onclick="moderateAction('resume_circles')">â–¶ï¸ Resume Circles</button>
                    <button onclick="moderateAction('reset_hack_attempts')">ğŸ”„ Reset Hacks</button>
                </div>
            </div>
        </div>
        
        <div class="tip-jar-controls">
            <h3>ğŸº Tip Jar Contributions</h3>
            <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                <select id="tip-type">
                    <option value="unix_keys">ğŸ”‘ Unix Keys</option>
                    <option value="theories">ğŸ§  Theories</option>
                    <option value="insights">ğŸ’¡ Insights</option>
                    <option value="api_credits">ğŸ’³ API Credits</option>
                    <option value="doubloons">ğŸª™ Doubloons</option>
                </select>
                <input type="number" id="tip-value" placeholder="Value" min="1" value="1">
                <input type="text" id="tip-message" placeholder="Message (optional)">
                <button onclick="contributeTip()">ğŸº Contribute to Tip Jar</button>
            </div>
        </div>
        
        <div class="log-panel">
            <h3>ğŸ“‹ Ark Activity Log</h3>
            <div id="activity-log">
                <div class="log-entry">ğŸº Tip Jar Ark Interface Ready</div>
                <div class="log-entry">âš“ Waiting for connections...</div>
            </div>
        </div>
    </div>
    
    <script>
        // WebSocket connections
        let connections = {
            gamemaster: null,
            unix: null,
            nonunix: null,
            moderator: null,
            tipjar: null
        };
        
        // Connection URLs
        const urls = {
            gamemaster: 'ws://localhost:9090?gamemaster=true',
            unix: 'ws://localhost:9090',
            nonunix: 'ws://localhost:9090',
            moderator: 'ws://localhost:8085',
            tipjar: 'ws://localhost:9091'
        };
        
        // Activity log
        function addLog(message, type = 'info') {
            const log = document.getElementById('activity-log');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.innerHTML = `${new Date().toLocaleTimeString()} - ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }
        
        // Update status displays
        function updateStatus(type, status) {
            const statusEl = document.getElementById(`${type}-status`);
            statusEl.className = `connection-status ${status}`;
            statusEl.textContent = status.charAt(0).toUpperCase() + status.slice(1);
        }
        
        // Connect as Game Master
        function connectGameMaster() {
            updateStatus('gamemaster', 'connecting');
            addLog('ğŸ® Connecting as Game Master...');
            
            connections.gamemaster = new WebSocket(urls.gamemaster);
            
            connections.gamemaster.onopen = () => {
                updateStatus('gamemaster', 'connected');
                document.getElementById('gamemaster-controls').style.display = 'block';
                document.getElementById('gamemaster-connect').textContent = 'Disconnect';
                document.getElementById('gamemaster-connect').onclick = disconnectGameMaster;
                addLog('ğŸ‘‘ Connected as Game Master!');
            };
            
            connections.gamemaster.onmessage = (event) => {
                const data = JSON.parse(event.data);
                handleGameMasterMessage(data);
            };
            
            connections.gamemaster.onclose = () => {
                updateStatus('gamemaster', 'disconnected');
                document.getElementById('gamemaster-controls').style.display = 'none';
                document.getElementById('gamemaster-connect').textContent = 'Connect as Game Master';
                document.getElementById('gamemaster-connect').onclick = connectGameMaster;
                addLog('ğŸ‘‘ Game Master disconnected');
            };
        }
        
        function disconnectGameMaster() {
            if (connections.gamemaster) {
                connections.gamemaster.close();
            }
        }
        
        // Connect as Unix User
        function connectUnixUser() {
            updateStatus('unix', 'connecting');
            addLog('ğŸ§ Connecting as Unix User...');
            
            connections.unix = new WebSocket(urls.unix);
            
            connections.unix.onopen = () => {
                updateStatus('unix', 'connected');
                document.getElementById('unix-info').style.display = 'block';
                document.getElementById('unix-connect').textContent = 'Disconnect';
                document.getElementById('unix-connect').onclick = disconnectUnixUser;
                addLog('ğŸ§ Connected as Unix User!');
            };
            
            connections.unix.onmessage = (event) => {
                const data = JSON.parse(event.data);
                handleUnixMessage(data);
            };
            
            connections.unix.onclose = () => {
                updateStatus('unix', 'disconnected');
                document.getElementById('unix-info').style.display = 'none';
                document.getElementById('unix-connect').textContent = 'Connect as Unix User';
                document.getElementById('unix-connect').onclick = connectUnixUser;
                addLog('ğŸ§ Unix User disconnected');
            };
        }
        
        function disconnectUnixUser() {
            if (connections.unix) {
                connections.unix.close();
            }
        }
        
        // Connect as Non-Unix User
        function connectNonUnixUser() {
            updateStatus('nonunix', 'connecting');
            addLog('ğŸ–¥ï¸ Connecting as Non-Unix User...');
            
            connections.nonunix = new WebSocket(urls.nonunix);
            
            connections.nonunix.onopen = () => {
                updateStatus('nonunix', 'connected');
                document.getElementById('nonunix-info').style.display = 'block';
                document.getElementById('nonunix-connect').textContent = 'Disconnect';
                document.getElementById('nonunix-connect').onclick = disconnectNonUnixUser;
                addLog('ğŸ–¥ï¸ Connected as Non-Unix User!');
            };
            
            connections.nonunix.onmessage = (event) => {
                const data = JSON.parse(event.data);
                handleNonUnixMessage(data);
            };
            
            connections.nonunix.onclose = () => {
                updateStatus('nonunix', 'disconnected');
                document.getElementById('nonunix-info').style.display = 'none';
                document.getElementById('nonunix-connect').textContent = 'Connect as Non-Unix User';
                document.getElementById('nonunix-connect').onclick = connectNonUnixUser;
                addLog('ğŸ–¥ï¸ Non-Unix User disconnected');
            };
        }
        
        function disconnectNonUnixUser() {
            if (connections.nonunix) {
                connections.nonunix.close();
            }
        }
        
        // Connect as Moderator
        function connectModerator() {
            updateStatus('moderator', 'connecting');
            addLog('ğŸ‘¨â€ğŸ« Connecting as Moderator...');
            
            connections.moderator = new WebSocket(urls.moderator);
            
            connections.moderator.onopen = () => {
                updateStatus('moderator', 'connected');
                document.getElementById('moderator-controls').style.display = 'block';
                document.getElementById('moderator-connect').textContent = 'Disconnect';
                document.getElementById('moderator-connect').onclick = disconnectModerator;
                addLog('ğŸ‘¨â€ğŸ« Connected as Moderator!');
            };
            
            connections.moderator.onmessage = (event) => {
                const data = JSON.parse(event.data);
                handleModeratorMessage(data);
            };
            
            connections.moderator.onclose = () => {
                updateStatus('moderator', 'disconnected');
                document.getElementById('moderator-controls').style.display = 'none';
                document.getElementById('moderator-connect').textContent = 'Connect as Moderator';
                document.getElementById('moderator-connect').onclick = connectModerator;
                addLog('ğŸ‘¨â€ğŸ« Moderator disconnected');
            };
        }
        
        function disconnectModerator() {
            if (connections.moderator) {
                connections.moderator.close();
            }
        }
        
        // Game Master Actions
        function startCircles() {
            if (connections.gamemaster) {
                connections.gamemaster.send(JSON.stringify({
                    type: 'start_circles'
                }));
                addLog('ğŸŒ€ Game Master started circular flow!');
            }
        }
        
        function stopCircles() {
            if (connections.gamemaster) {
                connections.gamemaster.send(JSON.stringify({
                    type: 'stop_circles'
                }));
                addLog('â¸ï¸ Game Master stopped circular flow');
            }
        }
        
        function changeDirection() {
            if (connections.gamemaster) {
                connections.gamemaster.send(JSON.stringify({
                    type: 'change_direction',
                    direction: Math.random() > 0.5 ? 'clockwise' : 'counterclockwise'
                }));
                addLog('ğŸ”„ Game Master changed circle direction');
            }
        }
        
        function adjustSpeed(direction) {
            if (connections.gamemaster) {
                connections.gamemaster.send(JSON.stringify({
                    type: 'adjust_speed',
                    speed: direction
                }));
                addLog(`${direction === 'faster' ? 'âš¡' : 'ğŸŒ'} Game Master adjusted circle speed`);
            }
        }
        
        function forceHack() {
            if (connections.gamemaster) {
                connections.gamemaster.send(JSON.stringify({
                    type: 'force_hack_attempt'
                }));
                addLog('ğŸ¯ Game Master forced a hack attempt!');
            }
        }
        
        function resetCircles() {
            if (connections.gamemaster) {
                connections.gamemaster.send(JSON.stringify({
                    type: 'reset_circles'
                }));
                addLog('ğŸ”„ Game Master reset all circles');
            }
        }
        
        function collectTips() {
            if (connections.gamemaster) {
                connections.gamemaster.send(JSON.stringify({
                    type: 'collect_tips'
                }));
                addLog('ğŸº Game Master collected tip jar!');
            }
        }
        
        // Unix User Actions
        function attemptHack() {
            if (connections.unix) {
                connections.unix.send(JSON.stringify({
                    type: 'attempt_hack',
                    method: 'brute_force'
                }));
                addLog('ğŸ¯ Unix user attempting to hack Game Master...');
            }
        }
        
        function reasonWithGameMaster() {
            const reasoning = prompt('Enter your reasoning to convince the Game Master:');
            if (reasoning && connections.unix) {
                connections.unix.send(JSON.stringify({
                    type: 'reason_with_gamemaster',
                    reasoning: reasoning
                }));
                addLog('ğŸ’­ Unix user attempting to reason with Game Master...');
            }
        }
        
        // Non-Unix User Actions
        function attemptBreakCircle() {
            if (connections.nonunix) {
                connections.nonunix.send(JSON.stringify({
                    type: 'break_circle'
                }));
                addLog('ğŸ’¥ Non-Unix user trying to break free from circles...');
            }
        }
        
        function useSpecialPrivilege() {
            if (connections.nonunix) {
                connections.nonunix.send(JSON.stringify({
                    type: 'use_privilege',
                    privilege: 'special_action'
                }));
                addLog('âœ¨ Non-Unix user using special privilege!');
            }
        }
        
        // Moderator Actions
        function moderateAction(action) {
            if (connections.moderator) {
                connections.moderator.send(JSON.stringify({
                    type: action,
                    moderator: 'guardian_teacher'
                }));
                addLog(`ğŸ‘¨â€ğŸ« Moderator action: ${action}`);
            }
        }
        
        // Tip Jar
        function contributeTip() {
            const type = document.getElementById('tip-type').value;
            const value = parseInt(document.getElementById('tip-value').value) || 1;
            const message = document.getElementById('tip-message').value;
            
            // Send to any connected WebSocket (they all handle tips)
            const tip = {
                type: 'contribute_tip',
                contribution: {
                    type: type,
                    value: value,
                    message: message,
                    contributor: 'interface_user'
                }
            };
            
            // Try to send via any available connection
            let sent = false;
            for (const [name, connection] of Object.entries(connections)) {
                if (connection && connection.readyState === WebSocket.OPEN) {
                    connection.send(JSON.stringify(tip));
                    sent = true;
                    break;
                }
            }
            
            if (sent) {
                addLog(`ğŸº Contributed ${value} ${type} to Tip Jar`);
                document.getElementById('tip-value').value = '1';
                document.getElementById('tip-message').value = '';
            } else {
                addLog('âŒ No connection available to send tip');
            }
        }
        
        // Message Handlers
        function handleGameMasterMessage(data) {
            switch (data.type) {
                case 'game_master_interface':
                    updateArkStatus(data.arkStatus);
                    break;
                case 'broadcast_notification':
                    addLog(`ğŸ“¢ Broadcast: ${data.message}`);
                    break;
                default:
                    addLog(`ğŸ‘‘ Game Master: ${data.message || JSON.stringify(data)}`);
            }
        }
        
        function handleUnixMessage(data) {
            switch (data.type) {
                case 'forced_circle':
                    document.getElementById('current-phase').textContent = data.phase;
                    document.getElementById('current-element').textContent = data.element;
                    addLog(`ğŸŒ€ Forced into circle: ${data.element}`);
                    break;
                case 'punishment_circles':
                    addLog(`ğŸ˜µ Punishment: ${data.extraCircles} extra circles!`);
                    break;
                default:
                    addLog(`ğŸ§ Unix: ${data.message || JSON.stringify(data)}`);
            }
        }
        
        function handleNonUnixMessage(data) {
            switch (data.type) {
                case 'special_privileges':
                    if (data.privileges) {
                        document.getElementById('can-see-gm').textContent = data.privileges.canSeeGameMaster ? 'Yes' : 'No';
                        document.getElementById('can-break').textContent = data.privileges.canBreakFreeFromCircles ? 'Yes' : 'No';
                    }
                    break;
                case 'special_circle':
                    addLog(`âœ¨ Special circle treatment: ${data.element}`);
                    break;
                default:
                    addLog(`ğŸ–¥ï¸ Non-Unix: ${data.message || JSON.stringify(data)}`);
            }
        }
        
        function handleModeratorMessage(data) {
            addLog(`ğŸ‘¨â€ğŸ« Moderator: ${data.message || JSON.stringify(data)}`);
        }
        
        function updateArkStatus(status) {
            if (status) {
                // Update capacity bars
                if (status.currentLoad) {
                    document.getElementById('unix-count').textContent = status.currentLoad.unix;
                    document.getElementById('nonunix-count').textContent = status.currentLoad.nonUnix;
                    document.getElementById('gamemaster-count').textContent = status.currentLoad.gameMaster;
                    
                    document.getElementById('unix-bar').style.width = `${(status.currentLoad.unix / 50) * 100}%`;
                    document.getElementById('nonunix-bar').style.width = `${(status.currentLoad.nonUnix / 3) * 100}%`;
                    document.getElementById('gamemaster-bar').style.width = `${status.currentLoad.gameMaster * 100}%`;
                }
                
                // Update circular flow
                if (status.circularFlow) {
                    document.getElementById('flow-speed').textContent = status.circularFlow.speed;
                    document.getElementById('flow-direction').textContent = 
                        status.gameState?.active ? 
                        (status.circularFlow.direction === 'clockwise' ? 'â†» Clockwise' : 'â†º Counter-clockwise') : 
                        'â¸ï¸ Stopped';
                }
                
                // Update tip jar
                if (status.tipJar) {
                    document.getElementById('tip-total').textContent = status.tipJar.totalValue;
                    document.getElementById('tip-count').textContent = status.tipJar.contributions;
                }
                
                // Update hack attempts
                if (status.gameState) {
                    document.getElementById('hack-count').textContent = status.gameState.hackAttempts?.size || 0;
                }
            }
        }
        
        // Auto-connect to tip jar for updates
        setTimeout(() => {
            connections.tipjar = new WebSocket(urls.tipjar);
            connections.tipjar.onmessage = (event) => {
                const data = JSON.parse(event.data);
                if (data.type === 'tip_jar_status') {
                    document.getElementById('tip-total').textContent = data.totalValue;
                    document.getElementById('tip-count').textContent = data.contributionCount;
                }
            };
        }, 1000);
        
        // Check Ark availability
        function checkArkAvailability() {
            const ws = new WebSocket('ws://localhost:9090');
            ws.onopen = () => {
                document.getElementById('ark-status').textContent = 'âœ… Ready for boarding';
                ws.close();
            };
            ws.onerror = () => {
                document.getElementById('ark-status').textContent = 'âŒ Ark not available - run start-tip-jar-ark.sh';
            };
        }
        
        // Check availability on load
        setTimeout(checkArkAvailability, 1000);
    </script>
</body>
</html>