<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåç Distributed MMORPG Universe - Everything Everywhere All At Once</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #0a0a1a 0%, #1a0a2a 50%, #2a0a1a 100%);
            color: #00ff88;
            min-height: 100vh;
            overflow-x: auto;
        }
        
        .header {
            text-align: center;
            padding: 20px;
            background: rgba(0, 255, 136, 0.1);
            border-bottom: 2px solid #00ff88;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 0 20px #00ff88;
        }
        
        .header p {
            font-size: 1.2em;
            color: #ffaa00;
        }
        
        .universe-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            padding: 20px;
            max-width: 1600px;
            margin: 0 auto;
        }
        
        .world-panel {
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid;
            border-radius: 15px;
            padding: 20px;
            position: relative;
            transition: all 0.3s ease;
        }
        
        .world-panel:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(0, 255, 136, 0.3);
        }
        
        .world-panel.hub { border-color: #00ff88; background: rgba(0, 255, 136, 0.1); }
        .world-panel.trading { border-color: #ffd700; background: rgba(255, 215, 0, 0.1); }
        .world-panel.ocean { border-color: #0088ff; background: rgba(0, 136, 255, 0.1); }
        .world-panel.combat { border-color: #ff4444; background: rgba(255, 68, 68, 0.1); }
        .world-panel.sky { border-color: #aa88ff; background: rgba(170, 136, 255, 0.1); }
        
        .world-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .world-title {
            font-size: 1.3em;
            font-weight: bold;
        }
        
        .world-status {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
        }
        
        .status-online { background: #00ff88; color: #000; }
        .status-active { background: #ffd700; color: #000; }
        .status-planned { background: #aa88ff; color: #000; }
        
        .world-content {
            line-height: 1.6;
        }
        
        .feature-list {
            list-style: none;
            margin: 10px 0;
        }
        
        .feature-list li {
            margin: 5px 0;
            padding-left: 20px;
            position: relative;
        }
        
        .feature-list li:before {
            content: '‚ö°';
            position: absolute;
            left: 0;
        }
        
        .cross-world-events {
            background: rgba(255, 170, 0, 0.1);
            border: 1px solid #ffaa00;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .event-log {
            max-height: 200px;
            overflow-y: auto;
            font-size: 0.9em;
        }
        
        .event-item {
            margin: 8px 0;
            padding: 8px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
            border-left: 3px solid #ffaa00;
        }
        
        .launch-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .launch-btn {
            background: linear-gradient(45deg, #00ff88, #0088ff);
            color: #000;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            text-decoration: none;
            display: inline-block;
            transition: all 0.3s;
            font-size: 0.9em;
        }
        
        .launch-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 255, 136, 0.4);
        }
        
        .launch-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: #666;
        }
        
        .stats-bar {
            display: flex;
            justify-content: space-around;
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.8em;
            color: #ff6600;
            margin-bottom: 5px;
        }
        
        .connection-lines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }
        
        .demo-controls {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #00ff88;
        }
        
        .demo-btn {
            background: #ff6600;
            color: white;
            border: none;
            padding: 10px 15px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .demo-btn:hover {
            background: #ff8833;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.6; }
            100% { opacity: 1; }
        }
        
        .online-indicator {
            animation: pulse 2s infinite;
        }
        
        .connection-status {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #00ff88;
            min-width: 200px;
        }
        
        .connection-item {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            font-size: 0.9em;
        }
        
        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
        }
        
        .status-connected { background: #00ff88; }
        .status-connecting { background: #ffaa00; }
        .status-disconnected { background: #ff4444; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üåç DISTRIBUTED MMORPG UNIVERSE</h1>
        <p><strong>Everything Everywhere All At Once</strong> - Like Xbox Live for GitHub Repos</p>
        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-value" id="totalWorlds">5</div>
                <div>Game Worlds</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="connectedWorlds">0</div>
                <div>Online Now</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="crossWorldEvents">0</div>
                <div>Cross Events</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="totalPlayers">0</div>
                <div>Active Players</div>
            </div>
        </div>
    </div>

    <div class="universe-container">
        <!-- Universal Metaverse Hub -->
        <div class="world-panel hub">
            <div class="world-header">
                <div class="world-title">üåç Universal Metaverse Hub</div>
                <div class="world-status status-online online-indicator">CENTRAL HUB</div>
            </div>
            <div class="world-content">
                <p><strong>Central coordination system connecting all game worlds</strong></p>
                <ul class="feature-list">
                    <li>Universal player identity (Soul of Soulfra)</li>
                    <li>Cross-world event broadcasting</li>
                    <li>Global leaderboards & achievements</li>
                    <li>Real-time world status monitoring</li>
                    <li>WebSocket mesh network</li>
                </ul>
                <div class="launch-buttons">
                    <a href="http://localhost:7000" target="_blank" class="launch-btn">Open Dashboard</a>
                    <button class="launch-btn" onclick="testConnection('hub')">Test Connection</button>
                </div>
            </div>
        </div>

        <!-- Trading Floor Hub -->
        <div class="world-panel trading">
            <div class="world-header">
                <div class="world-title">üí∞ Trading Floor Hub</div>
                <div class="world-status status-active">LIVE DATA</div>
            </div>
            <div class="world-content">
                <p><strong>Real-time crypto trading with live market data</strong></p>
                <ul class="feature-list">
                    <li>Real BTC/ETH/SOL prices (no more fake data!)</li>
                    <li>Grand Exchange with live crypto prices</li>
                    <li>Automated trading narratives</li>
                    <li>Tiered access (free/paid/premium)</li>
                    <li>Sports education integration</li>
                </ul>
                <div class="launch-buttons">
                    <a href="http://localhost:9600" target="_blank" class="launch-btn">Grand Exchange</a>
                    <a href="http://localhost:3335" target="_blank" class="launch-btn">Ticker Tape</a>
                    <button class="launch-btn" onclick="simulateTrading()">Simulate Trade</button>
                </div>
            </div>
        </div>

        <!-- Ocean World -->
        <div class="world-panel ocean">
            <div class="world-header">
                <div class="world-title">üåä Deep Sea Explorer</div>
                <div class="world-status status-active">EXPLORING</div>
            </div>
            <div class="world-content">
                <p><strong>Underwater treasure hunting and deep sea exploration</strong></p>
                <ul class="feature-list">
                    <li>Dive to depths up to 300 meters</li>
                    <li>Find rare treasures & artifacts</li>
                    <li>Encounter sea creatures & dangers</li>
                    <li>Upgrade diving equipment</li>
                    <li>Treasure affects ship purchases!</li>
                </ul>
                <div class="launch-buttons">
                    <a href="http://localhost:8000" target="_blank" class="launch-btn">Dive Deep</a>
                    <button class="launch-btn" onclick="simulateDiving()">Find Treasure</button>
                </div>
            </div>
        </div>

        <!-- Ship Combat Arena -->
        <div class="world-panel combat">
            <div class="world-header">
                <div class="world-title">üö¢ Naval Battle Arena</div>
                <div class="world-status status-active">BATTLING</div>
            </div>
            <div class="world-content">
                <p><strong>Epic naval battles with physics-based cannonball combat</strong></p>
                <ul class="feature-list">
                    <li>Real-time cannonball physics</li>
                    <li>Fleet management & ship upgrades</li>
                    <li>Treasure-based ship purchases</li>
                    <li>Multiplayer naval battles</li>
                    <li>Ocean treasure buys cannons!</li>
                </ul>
                <div class="launch-buttons">
                    <a href="http://localhost:8100" target="_blank" class="launch-btn">Battle Now</a>
                    <button class="launch-btn" onclick="simulateBattle()">Fire Cannons</button>
                </div>
            </div>
        </div>

        <!-- Sky Realm (Coming Soon) -->
        <div class="world-panel sky">
            <div class="world-header">
                <div class="world-title">‚òÅÔ∏è Sky Realm Battles</div>
                <div class="world-status status-planned">COMING SOON</div>
            </div>
            <div class="world-content">
                <p><strong>Aerial combat with flying ships in the clouds</strong></p>
                <ul class="feature-list">
                    <li>Flying ship combat mechanics</li>
                    <li>Cloud-based treasure hunting</li>
                    <li>3D aerial maneuvers</li>
                    <li>Wind physics & weather effects</li>
                    <li>Sky islands exploration</li>
                </ul>
                <div class="launch-buttons">
                    <button class="launch-btn" disabled>Coming Soon</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Cross-World Events Feed -->
    <div class="cross-world-events">
        <h3>üåê Cross-World Events (Everything Everywhere All At Once)</h3>
        <div class="event-log" id="eventLog">
            <div class="event-item">üéØ System initialized - All worlds ready for cross-world events</div>
            <div class="event-item">üë§ Universal player identity system active</div>
            <div class="event-item">üîó Cross-world communication established</div>
        </div>
    </div>

    <!-- Connection Status -->
    <div class="connection-status">
        <h4>üì° Connection Status</h4>
        <div class="connection-item">
            <span>Universal Hub</span>
            <span class="status-dot status-connecting" id="hubStatus"></span>
        </div>
        <div class="connection-item">
            <span>Trading Floor</span>
            <span class="status-dot status-connecting" id="tradingStatus"></span>
        </div>
        <div class="connection-item">
            <span>Ocean World</span>
            <span class="status-dot status-connecting" id="oceanStatus"></span>
        </div>
        <div class="connection-item">
            <span>Ship Combat</span>
            <span class="status-dot status-connecting" id="combatStatus"></span>
        </div>
    </div>

    <!-- Demo Controls -->
    <div class="demo-controls">
        <h4>üéÆ Demo Controls</h4>
        <button class="demo-btn" onclick="runFullDemo()">Run Full Demo</button>
        <button class="demo-btn" onclick="launchUniverse()">Launch Universe</button>
        <button class="demo-btn" onclick="testIntegration()">Test Integration</button>
    </div>

    <!-- Canvas for connection lines -->
    <canvas class="connection-lines" id="connectionCanvas"></canvas>

    <script>
        let ws = null;
        let eventCounter = 0;
        let connectionStates = {
            hub: false,
            trading: false,
            ocean: false,
            combat: false
        };

        // Initialize connection to Universal Hub
        function connectToHub() {
            try {
                ws = new WebSocket('ws://localhost:7001');
                
                ws.onopen = function() {
                    console.log('Connected to Universal Hub');
                    updateConnectionStatus('hubStatus', 'connected');
                    connectionStates.hub = true;
                    addEvent('üîó Connected to Universal Metaverse Hub');
                    
                    // Register as demo client
                    ws.send(JSON.stringify({
                        type: 'player_connect',
                        playerId: 'demo-player',
                        currentWorld: 'demo-interface',
                        timestamp: Date.now()
                    }));
                };
                
                ws.onmessage = function(event) {
                    const data = JSON.parse(event.data);
                    handleHubMessage(data);
                };
                
                ws.onclose = function() {
                    updateConnectionStatus('hubStatus', 'disconnected');
                    connectionStates.hub = false;
                    addEvent('‚ùå Disconnected from Universal Hub');
                    
                    // Reconnect after 3 seconds
                    setTimeout(connectToHub, 3000);
                };
                
                ws.onerror = function(error) {
                    console.error('WebSocket error:', error);
                    updateConnectionStatus('hubStatus', 'disconnected');
                };
                
            } catch (error) {
                console.error('Failed to connect to hub:', error);
                updateConnectionStatus('hubStatus', 'disconnected');
            }
        }

        function handleHubMessage(data) {
            switch (data.type) {
                case 'hub_welcome':
                    addEvent(`üåç Welcome! Available worlds: ${data.availableWorlds.join(', ')}`);
                    break;
                    
                case 'cross_world_event':
                    addEvent(`üåê Cross-world event: ${data.event.action} from ${data.event.sourceWorld}`);
                    eventCounter++;
                    document.getElementById('crossWorldEvents').textContent = eventCounter;
                    break;
                    
                case 'world_online':
                    addEvent(`üåç World online: ${data.worldData.name}`);
                    updateWorldConnection(data.worldId, true);
                    break;
                    
                case 'soul_data':
                    if (data.soul) {
                        addEvent(`üë§ Soul loaded: Level ${data.soul.universeStats?.universalLevel || 1}`);
                    }
                    break;
            }
            
            updateStats();
        }

        function addEvent(message) {
            const eventLog = document.getElementById('eventLog');
            const eventItem = document.createElement('div');
            eventItem.className = 'event-item';
            eventItem.textContent = `${new Date().toLocaleTimeString()} - ${message}`;
            
            eventLog.insertBefore(eventItem, eventLog.firstChild);
            
            // Keep only last 10 events
            while (eventLog.children.length > 10) {
                eventLog.removeChild(eventLog.lastChild);
            }
        }

        function updateConnectionStatus(elementId, status) {
            const element = document.getElementById(elementId);
            element.className = `status-dot status-${status}`;
        }

        function updateWorldConnection(worldId, connected) {
            const statusMap = {
                'trading-floor': 'tradingStatus',
                'ocean-world': 'oceanStatus', 
                'ship-combat': 'combatStatus'
            };
            
            if (statusMap[worldId]) {
                updateConnectionStatus(statusMap[worldId], connected ? 'connected' : 'disconnected');
                connectionStates[worldId.replace('-', '')] = connected;
            }
        }

        function updateStats() {
            const connectedCount = Object.values(connectionStates).filter(Boolean).length;
            document.getElementById('connectedWorlds').textContent = connectedCount;
        }

        // Demo functions
        function simulateTrading() {
            const profits = [500, 1200, 2500, 800, 3200];
            const profit = profits[Math.floor(Math.random() * profits.length)];
            
            addEvent(`üí∞ Profitable trade executed: +${profit} coins`);
            addEvent(`ü§ø Using profits to upgrade diving equipment`);
            
            if (ws && ws.readyState === WebSocket.OPEN) {
                ws.send(JSON.stringify({
                    type: 'cross_world_action',
                    playerId: 'demo-player',
                    sourceWorld: 'trading-floor',
                    action: 'profitable_trade',
                    data: { profit, upgrade: 'diving_suit' },
                    affectedWorlds: ['ocean-world'],
                    timestamp: Date.now()
                }));
            }
        }

        function simulateDiving() {
            const treasures = [
                'Ancient Compass', 'Deep Sea Pearl', 'Sunken Doubloon', 
                'Legendary Trident', 'Crystal Formation'
            ];
            const treasure = treasures[Math.floor(Math.random() * treasures.length)];
            const value = Math.floor(Math.random() * 3000) + 500;
            
            addEvent(`üèÜ Treasure found: ${treasure} (worth ${value} coins)`);
            addEvent(`üö¢ Using treasure to purchase ship cannons`);
            
            if (ws && ws.readyState === WebSocket.OPEN) {
                ws.send(JSON.stringify({
                    type: 'cross_world_action',
                    playerId: 'demo-player',
                    sourceWorld: 'ocean-world',
                    action: 'treasure_found',
                    data: { treasure, value, upgrade: 'ship_cannons' },
                    affectedWorlds: ['ship-combat'],
                    timestamp: Date.now()
                }));
            }
        }

        function simulateBattle() {
            const outcomes = ['Victory', 'Defeat', 'Draw'];
            const outcome = outcomes[Math.floor(Math.random() * outcomes.length)];
            const reward = outcome === 'Victory' ? Math.floor(Math.random() * 1000) + 200 : 0;
            
            addEvent(`‚öîÔ∏è Naval battle result: ${outcome}${reward > 0 ? ` (+${reward} coins)` : ''}`);
            
            if (reward > 0) {
                addEvent(`üí∞ Using battle rewards for trading capital`);
                
                if (ws && ws.readyState === WebSocket.OPEN) {
                    ws.send(JSON.stringify({
                        type: 'cross_world_action',
                        playerId: 'demo-player',
                        sourceWorld: 'ship-combat',
                        action: 'battle_victory',
                        data: { outcome, reward, upgrade: 'trading_capital' },
                        affectedWorlds: ['trading-floor'],
                        timestamp: Date.now()
                    }));
                }
            }
        }

        function testConnection(service) {
            const urls = {
                hub: 'http://localhost:7000/api/stats',
                trading: 'http://localhost:9600',
                ocean: 'http://localhost:8000', 
                combat: 'http://localhost:8100'
            };
            
            if (urls[service]) {
                fetch(urls[service])
                    .then(response => {
                        if (response.ok) {
                            addEvent(`‚úÖ ${service} connection successful`);
                        } else {
                            addEvent(`‚ö†Ô∏è ${service} responded with status ${response.status}`);
                        }
                    })
                    .catch(error => {
                        addEvent(`‚ùå ${service} connection failed - may not be running`);
                    });
            }
        }

        function runFullDemo() {
            addEvent('üöÄ Running full cross-world demo...');
            
            setTimeout(() => simulateTrading(), 1000);
            setTimeout(() => simulateDiving(), 3000);
            setTimeout(() => simulateBattle(), 5000);
            setTimeout(() => addEvent('üéâ Demo complete! Cross-world integration working!'), 7000);
        }

        function launchUniverse() {
            addEvent('üöÄ Launching distributed universe...');
            addEvent('üí° Run: ./launch-distributed-universe.sh in terminal');
        }

        function testIntegration() {
            addEvent('üß™ Running integration test...');
            addEvent('üí° Run: node test-cross-world-integration.js in terminal');
        }

        // Auto-check connections every 10 seconds
        setInterval(() => {
            testConnection('hub');
            testConnection('trading');
            testConnection('ocean');
            testConnection('combat');
        }, 10000);

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            addEvent('üåü Universe demo interface loaded');
            addEvent('üí° Run ./launch-distributed-universe.sh to start all worlds');
            
            // Try to connect to hub
            connectToHub();
            
            // Initial connection tests
            setTimeout(() => {
                testConnection('hub');
                testConnection('trading');
                testConnection('ocean');
                testConnection('combat');
            }, 2000);
        });

        // Update stats periodically
        setInterval(async () => {
            try {
                const response = await fetch('http://localhost:7000/api/stats');
                const stats = await response.json();
                
                document.getElementById('connectedWorlds').textContent = stats.connectedWorlds || 0;
                document.getElementById('totalPlayers').textContent = stats.connectedPlayers || 0;
                document.getElementById('crossWorldEvents').textContent = stats.crossWorldEvents || eventCounter;
                
            } catch (error) {
                // Hub not available
            }
        }, 5000);
    </script>
</body>
</html>