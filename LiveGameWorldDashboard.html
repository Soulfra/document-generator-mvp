<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Game World Dashboard - Persistent Universe Command Center</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Consolas', 'Monaco', monospace;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 25%, #16213e 50%, #0f3460 75%, #533483 100%);
            color: #00ff88;
            overflow: hidden;
            height: 100vh;
        }

        .dashboard-container {
            display: grid;
            grid-template-columns: 300px 1fr 350px;
            grid-template-rows: 80px 1fr 200px;
            height: 100vh;
            gap: 10px;
            padding: 10px;
        }

        .header {
            grid-column: 1 / -1;
            background: linear-gradient(90deg, #0066cc, #8A2BE2, #00ff88);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 30px;
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.3);
            border: 2px solid #00ff88;
        }

        .header h1 {
            font-size: 28px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 15px;
            color: #ffffff;
            text-shadow: 0 0 10px #00ff88;
        }

        .universe-status {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .status-indicator {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            animation: pulse 2s infinite;
            box-shadow: 0 0 10px currentColor;
        }

        .status-online { background: #00ff88; }
        .status-syncing { background: #ffaa00; }
        .status-offline { background: #ff4444; }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.2); }
        }

        .left-panel {
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #00ff88;
            border-radius: 10px;
            padding: 20px;
            overflow-y: auto;
            box-shadow: inset 0 0 20px rgba(0, 255, 136, 0.1);
        }

        .main-view {
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #8A2BE2;
            border-radius: 10px;
            padding: 20px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 0 30px rgba(138, 43, 226, 0.2);
        }

        .right-panel {
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #0066cc;
            border-radius: 10px;
            padding: 20px;
            overflow-y: auto;
            box-shadow: inset 0 0 20px rgba(0, 102, 204, 0.1);
        }

        .footer {
            grid-column: 1 / -1;
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid #533483;
            border-radius: 10px;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: inset 0 0 20px rgba(83, 52, 131, 0.2);
        }

        .section-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #ffffff;
            text-shadow: 0 0 8px currentColor;
            border-bottom: 1px solid #00ff88;
            padding-bottom: 5px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0, 255, 136, 0.2);
        }

        .stat-label {
            color: #cccccc;
            font-size: 14px;
        }

        .stat-value {
            color: #00ff88;
            font-weight: bold;
            font-size: 16px;
            text-shadow: 0 0 5px #00ff88;
        }

        .world-map {
            width: 100%;
            height: 400px;
            background: radial-gradient(circle at center, #1a1a2e 0%, #0a0a0a 100%);
            border: 1px solid #8A2BE2;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .territory {
            position: absolute;
            border: 2px solid;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            text-align: center;
        }

        .territory:hover {
            transform: scale(1.1);
            z-index: 10;
            box-shadow: 0 0 20px currentColor;
        }

        .territory.gaming { border-color: #ff6b6b; color: #ff6b6b; }
        .territory.ai { border-color: #4ecdc4; color: #4ecdc4; }
        .territory.business { border-color: #45b7d1; color: #45b7d1; }
        .territory.api { border-color: #f9ca24; color: #f9ca24; }
        .territory.crypto { border-color: #f0932b; color: #f0932b; }
        .territory.security { border-color: #eb4d4b; color: #eb4d4b; }
        .territory.creative { border-color: #6c5ce7; color: #6c5ce7; }
        .territory.unified { border-color: #00ff88; color: #00ff88; }

        .progression-bar {
            width: 100%;
            height: 20px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
            border: 1px solid #00ff88;
        }

        .progression-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff88, #0066cc);
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px #00ff88;
        }

        .business-idea {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid #00ff88;
            border-radius: 5px;
            padding: 10px;
            margin: 5px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .business-idea:hover {
            background: rgba(0, 255, 136, 0.2);
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.3);
        }

        .business-idea.unlocked {
            border-color: #00ff88;
            background: rgba(0, 255, 136, 0.2);
        }

        .business-idea.locked {
            border-color: #666666;
            background: rgba(102, 102, 102, 0.1);
            color: #888888;
        }

        .connection-line {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, transparent, #00ff88, transparent);
            animation: flow 2s infinite;
            pointer-events: none;
        }

        @keyframes flow {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        .live-metrics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .metric-card {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid #00ff88;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
            transform: translateY(-2px);
        }

        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #00ff88;
            text-shadow: 0 0 10px #00ff88;
        }

        .metric-label {
            font-size: 12px;
            color: #cccccc;
            margin-top: 5px;
        }

        .console-output {
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid #00ff88;
            border-radius: 5px;
            padding: 10px;
            height: 150px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }

        .console-line {
            margin: 2px 0;
        }

        .console-line.info { color: #00ff88; }
        .console-line.warning { color: #ffaa00; }
        .console-line.error { color: #ff4444; }
        .console-line.success { color: #00ff88; }

        .control-button {
            background: linear-gradient(45deg, #0066cc, #8A2BE2);
            border: 1px solid #00ff88;
            border-radius: 5px;
            color: #ffffff;
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
            font-weight: bold;
        }

        .control-button:hover {
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.5);
            transform: scale(1.05);
        }

        .never-reset-indicator {
            background: linear-gradient(45deg, #00ff88, #0066cc);
            border-radius: 20px;
            padding: 5px 15px;
            font-size: 12px;
            font-weight: bold;
            color: #000000;
            animation: glow 3s infinite;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 10px rgba(0, 255, 136, 0.5); }
            50% { box-shadow: 0 0 25px rgba(0, 255, 136, 0.8); }
        }

        .scrollbar-custom::-webkit-scrollbar {
            width: 8px;
        }

        .scrollbar-custom::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
        }

        .scrollbar-custom::-webkit-scrollbar-thumb {
            background: #00ff88;
            border-radius: 4px;
        }

        .scrollbar-custom::-webkit-scrollbar-thumb:hover {
            background: #0066cc;
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Header -->
        <div class="header">
            <h1>
                üåç LIVE GAME WORLD DASHBOARD
                <span class="never-reset-indicator">STATE NEVER RESETS</span>
            </h1>
            <div class="universe-status">
                <div>Empire Bridge: <span class="status-indicator status-online" id="empire-status"></span></div>
                <div>Gateway: <span class="status-indicator status-online" id="gateway-status"></span></div>
                <div>PostgreSQL: <span class="status-indicator status-online" id="db-status"></span></div>
                <div>Level: <span class="stat-value" id="player-level">‚àû</span></div>
            </div>
        </div>

        <!-- Left Panel: Persistent Progression -->
        <div class="left-panel scrollbar-custom">
            <div class="section-title">üõ°Ô∏è PERSISTENT PROGRESSION</div>
            
            <div class="stat-item">
                <span class="stat-label">Total Experience</span>
                <span class="stat-value" id="total-experience">0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Highest Level</span>
                <span class="stat-value" id="highest-level">1</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Days Active</span>
                <span class="stat-value" id="days-active">0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Never Reset Score</span>
                <span class="stat-value" id="never-reset-score">0</span>
            </div>

            <div class="section-title" style="margin-top: 20px;">üèÜ ACHIEVEMENTS</div>
            <div class="stat-item">
                <span class="stat-label">Lifetime Achievements</span>
                <span class="stat-value" id="lifetime-achievements">0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Milestones Unlocked</span>
                <span class="stat-value" id="milestones-unlocked">0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Permanent Upgrades</span>
                <span class="stat-value" id="permanent-upgrades">0</span>
            </div>

            <div class="section-title" style="margin-top: 20px;">üìä SYSTEM INTEGRITY</div>
            <div class="stat-item">
                <span class="stat-label">Backups Created</span>
                <span class="stat-value" id="backups-created">0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Last Integrity Check</span>
                <span class="stat-value" id="last-integrity-check">--:--</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">State Health</span>
                <span class="stat-value" id="state-health">HEALTHY</span>
            </div>
        </div>

        <!-- Main View: World Map & Territory Control -->
        <div class="main-view">
            <div class="section-title">üó∫Ô∏è UNIFIED GAME WORLD MAP</div>
            
            <div class="world-map" id="world-map">
                <!-- Territories will be dynamically generated -->
            </div>

            <div class="section-title">üìà REAL-TIME PROGRESSION</div>
            <div class="progression-bar">
                <div class="progression-fill" id="experience-progress" style="width: 0%;"></div>
            </div>
            <div style="text-align: center; margin-top: 10px;">
                <span id="progression-text">Experience Progress: 0 / 1000</span>
            </div>

            <div class="live-metrics">
                <div class="metric-card">
                    <div class="metric-value" id="empire-files-count">0</div>
                    <div class="metric-label">Empire Files Mapped</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="territories-controlled">0</div>
                    <div class="metric-label">Territories Controlled</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="active-connections">0</div>
                    <div class="metric-label">Active Connections</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="world-influence">0</div>
                    <div class="metric-label">World Influence Score</div>
                </div>
            </div>
        </div>

        <!-- Right Panel: Business Ideas & Live Status -->
        <div class="right-panel scrollbar-custom">
            <div class="section-title">üí° BUSINESS IDEA PROGRESSION</div>
            
            <div class="stat-item">
                <span class="stat-label">Ideas Available</span>
                <span class="stat-value" id="ideas-available">7137</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Ideas Unlocked</span>
                <span class="stat-value" id="ideas-unlocked">0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Ideas Implemented</span>
                <span class="stat-value" id="ideas-implemented">0</span>
            </div>

            <div class="section-title" style="margin-top: 20px;">üîì RECENTLY UNLOCKED</div>
            <div id="recent-unlocks">
                <div class="business-idea unlocked">
                    <strong>Production Platform</strong><br>
                    <small>Ready for implementation</small>
                </div>
                <div class="business-idea unlocked">
                    <strong>Empire Bridge Connection</strong><br>
                    <small>14,873 files discovered</small>
                </div>
                <div class="business-idea locked">
                    <strong>Advanced AI Integration</strong><br>
                    <small>Requires Level 5</small>
                </div>
            </div>

            <div class="section-title" style="margin-top: 20px;">üîó INFRASTRUCTURE</div>
            <div class="stat-item">
                <span class="stat-label">Empire Bridge</span>
                <span class="stat-value" id="empire-bridge-status">CONNECTED</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Unified Gateway</span>
                <span class="stat-value" id="gateway-status-text">ACTIVE</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">PostgreSQL DB</span>
                <span class="stat-value" id="db-status-text">PERSISTENT</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Redis Cache</span>
                <span class="stat-value" id="redis-status">OPERATIONAL</span>
            </div>
        </div>

        <!-- Footer: Live Console & Controls -->
        <div class="footer">
            <div style="flex: 1; margin-right: 20px;">
                <div class="section-title">üì∫ LIVE SYSTEM CONSOLE</div>
                <div class="console-output scrollbar-custom" id="console-output">
                    <div class="console-line success">[SYSTEM] Live Game World Dashboard initialized</div>
                    <div class="console-line info">[EMPIRE] Connecting to Empire Bridge (port 3333)...</div>
                    <div class="console-line info">[GATEWAY] Connecting to Unified Gateway (port 4444)...</div>
                    <div class="console-line success">[DATABASE] PostgreSQL persistent storage active</div>
                    <div class="console-line info">[PROGRESSION] Loading persistent state...</div>
                </div>
            </div>
            
            <div style="display: flex; flex-direction: column; gap: 10px;">
                <button class="control-button" onclick="refreshWorldState()">üîÑ Refresh World</button>
                <button class="control-button" onclick="triggerBackup()">üíæ Create Backup</button>
                <button class="control-button" onclick="checkIntegrity()">üîç Check Integrity</button>
                <button class="control-button" onclick="exportState()">üì§ Export State</button>
            </div>
        </div>
    </div>

    <script>
        // Live Game World Dashboard JavaScript
        class LiveGameWorldDashboard {
            constructor() {
                this.empireBaseURL = 'http://localhost:3333';
                this.gatewayBaseURL = 'http://localhost:4444';
                this.updateInterval = 5000; // 5 seconds
                this.connectionStatus = {
                    empire: false,
                    gateway: false,
                    database: false
                };
                
                // Game world state
                this.gameState = {
                    playerProgression: {
                        totalExperience: 0,
                        highestLevel: 1,
                        daysActive: 0,
                        neverResetScore: 0
                    },
                    worldState: {
                        empireFiles: 0,
                        territoriesControlled: 0,
                        businessIdeasUnlocked: 0,
                        activeConnections: 0,
                        worldInfluence: 0
                    },
                    achievements: {
                        lifetimeAchievements: 0,
                        milestonesUnlocked: 0,
                        permanentUpgrades: 0
                    },
                    systemIntegrity: {
                        backupsCreated: 0,
                        lastIntegrityCheck: new Date(),
                        stateHealth: 'HEALTHY'
                    }
                };
                
                this.initializeDashboard();
            }
            
            async initializeDashboard() {
                console.log('üåç Initializing Live Game World Dashboard...');
                
                // Generate territory map
                this.generateTerritoryMap();
                
                // Start real-time updates
                this.startRealTimeUpdates();
                
                // Initialize connection monitoring
                this.startConnectionMonitoring();
                
                // Load initial state
                await this.loadGameWorldState();
                
                this.logToConsole('success', '[DASHBOARD] Live Game World Dashboard fully operational');
            }
            
            generateTerritoryMap() {
                const worldMap = document.getElementById('world-map');
                const territories = [
                    { name: 'Gaming Empire', class: 'gaming', x: 10, y: 10, w: 100, h: 80 },
                    { name: 'AI Territories', class: 'ai', x: 130, y: 20, w: 120, h: 60 },
                    { name: 'Business District', class: 'business', x: 270, y: 30, w: 110, h: 70 },
                    { name: 'API Gateway Sector', class: 'api', x: 400, y: 15, w: 100, h: 85 },
                    { name: 'Crypto Realms', class: 'crypto', x: 20, y: 120, w: 90, h: 90 },
                    { name: 'Security Fortress', class: 'security', x: 130, y: 100, w: 100, h: 100 },
                    { name: 'Creative Quarters', class: 'creative', x: 250, y: 120, w: 120, h: 80 },
                    { name: 'Unified Command', class: 'unified', x: 390, y: 120, w: 110, h: 90 }
                ];
                
                worldMap.innerHTML = '';
                
                territories.forEach(territory => {
                    const territoryEl = document.createElement('div');
                    territoryEl.className = `territory ${territory.class}`;
                    territoryEl.style.left = `${territory.x}px`;
                    territoryEl.style.top = `${territory.y}px`;
                    territoryEl.style.width = `${territory.w}px`;
                    territoryEl.style.height = `${territory.h}px`;
                    territoryEl.textContent = territory.name;
                    territoryEl.onclick = () => this.selectTerritory(territory);
                    worldMap.appendChild(territoryEl);
                });
                
                // Add connection lines
                this.addConnectionLines(worldMap);
            }
            
            addConnectionLines(worldMap) {
                const connections = [
                    { from: {x: 160, y: 50}, to: {x: 320, y: 60} },
                    { from: {x: 180, y: 150}, to: {x: 300, y: 160} },
                    { from: {x: 450, y: 50}, to: {x: 440, y: 160} }
                ];
                
                connections.forEach((conn, index) => {
                    const line = document.createElement('div');
                    line.className = 'connection-line';
                    const length = Math.sqrt(Math.pow(conn.to.x - conn.from.x, 2) + Math.pow(conn.to.y - conn.from.y, 2));
                    const angle = Math.atan2(conn.to.y - conn.from.y, conn.to.x - conn.from.x) * 180 / Math.PI;
                    
                    line.style.left = `${conn.from.x}px`;
                    line.style.top = `${conn.from.y}px`;
                    line.style.width = `${length}px`;
                    line.style.transform = `rotate(${angle}deg)`;
                    line.style.transformOrigin = '0 50%';
                    line.style.animationDelay = `${index * 0.5}s`;
                    
                    worldMap.appendChild(line);
                });
            }
            
            async startRealTimeUpdates() {
                setInterval(async () => {
                    await this.updateGameWorldState();
                    this.updateProgressionBar();
                    this.updateLiveMetrics();
                }, this.updateInterval);
                
                this.logToConsole('info', '[UPDATES] Real-time updates started (5s interval)');
            }
            
            async startConnectionMonitoring() {
                setInterval(async () => {
                    await this.checkEmpireBridgeConnection();
                    await this.checkGatewayConnection();
                    this.updateConnectionIndicators();
                }, 10000); // Every 10 seconds
                
                this.logToConsole('info', '[MONITOR] Connection monitoring started');
            }
            
            async checkEmpireBridgeConnection() {
                try {
                    const response = await fetch(`${this.empireBaseURL}/api/status`);
                    this.connectionStatus.empire = response.ok;
                    
                    if (response.ok) {
                        const status = await response.json();
                        this.gameState.worldState.empireFiles = status.discovered_files || 14873;
                    }
                } catch (error) {
                    this.connectionStatus.empire = false;
                    this.logToConsole('warning', '[EMPIRE] Bridge connection lost');
                }
            }
            
            async checkGatewayConnection() {
                try {
                    const response = await fetch(`${this.gatewayBaseURL}/api/health`);
                    this.connectionStatus.gateway = response.ok;
                } catch (error) {
                    this.connectionStatus.gateway = false;
                    this.logToConsole('warning', '[GATEWAY] Gateway connection lost');
                }
            }
            
            updateConnectionIndicators() {
                const empireStatus = document.getElementById('empire-status');
                const gatewayStatus = document.getElementById('gateway-status');
                const dbStatus = document.getElementById('db-status');
                
                empireStatus.className = `status-indicator ${this.connectionStatus.empire ? 'status-online' : 'status-offline'}`;
                gatewayStatus.className = `status-indicator ${this.connectionStatus.gateway ? 'status-online' : 'status-offline'}`;
                dbStatus.className = `status-indicator status-online`; // Assume DB is always available
            }
            
            async loadGameWorldState() {
                // Simulate loading state from persistent storage
                this.gameState.playerProgression.totalExperience = 8750;
                this.gameState.playerProgression.highestLevel = Math.floor(Math.sqrt(this.gameState.playerProgression.totalExperience / 100)) + 1;
                this.gameState.playerProgression.daysActive = 42;
                this.gameState.playerProgression.neverResetScore = 15420;
                
                this.gameState.worldState.empireFiles = 14873;
                this.gameState.worldState.territoriesControlled = 8;
                this.gameState.worldState.businessIdeasUnlocked = 127;
                this.gameState.worldState.activeConnections = 45;
                this.gameState.worldState.worldInfluence = 2840;
                
                this.gameState.achievements.lifetimeAchievements = 23;
                this.gameState.achievements.milestonesUnlocked = 8;
                this.gameState.achievements.permanentUpgrades = 12;
                
                this.gameState.systemIntegrity.backupsCreated = 156;
                
                this.updateAllDisplayValues();
                this.logToConsole('success', '[STATE] Persistent game state loaded');
            }
            
            async updateGameWorldState() {
                // Simulate real-time state updates
                this.gameState.playerProgression.totalExperience += Math.floor(Math.random() * 10) + 5;
                this.gameState.playerProgression.neverResetScore += Math.floor(Math.random() * 3) + 1;
                this.gameState.worldState.worldInfluence += Math.floor(Math.random() * 5) + 1;
                
                // Check for level ups
                const newLevel = Math.floor(Math.sqrt(this.gameState.playerProgression.totalExperience / 100)) + 1;
                if (newLevel > this.gameState.playerProgression.highestLevel) {
                    this.gameState.playerProgression.highestLevel = newLevel;
                    this.logToConsole('success', `[PROGRESSION] Level up! Reached level ${newLevel}`);
                }
                
                this.updateAllDisplayValues();
            }
            
            updateAllDisplayValues() {
                // Update progression display
                document.getElementById('total-experience').textContent = this.gameState.playerProgression.totalExperience.toLocaleString();
                document.getElementById('highest-level').textContent = this.gameState.playerProgression.highestLevel;
                document.getElementById('player-level').textContent = this.gameState.playerProgression.highestLevel;
                document.getElementById('days-active').textContent = this.gameState.playerProgression.daysActive;
                document.getElementById('never-reset-score').textContent = this.gameState.playerProgression.neverResetScore.toLocaleString();
                
                // Update achievements
                document.getElementById('lifetime-achievements').textContent = this.gameState.achievements.lifetimeAchievements;
                document.getElementById('milestones-unlocked').textContent = this.gameState.achievements.milestonesUnlocked;
                document.getElementById('permanent-upgrades').textContent = this.gameState.achievements.permanentUpgrades;
                
                // Update system integrity
                document.getElementById('backups-created').textContent = this.gameState.systemIntegrity.backupsCreated;
                document.getElementById('last-integrity-check').textContent = new Date().toLocaleTimeString();
                document.getElementById('state-health').textContent = this.gameState.systemIntegrity.stateHealth;
                
                // Update world state
                document.getElementById('empire-files-count').textContent = this.gameState.worldState.empireFiles.toLocaleString();
                document.getElementById('territories-controlled').textContent = this.gameState.worldState.territoriesControlled;
                document.getElementById('active-connections').textContent = this.gameState.worldState.activeConnections;
                document.getElementById('world-influence').textContent = this.gameState.worldState.worldInfluence.toLocaleString();
                
                // Update business ideas
                document.getElementById('ideas-unlocked').textContent = this.gameState.worldState.businessIdeasUnlocked;
            }
            
            updateProgressionBar() {
                const currentLevel = this.gameState.playerProgression.highestLevel;
                const currentExp = this.gameState.playerProgression.totalExperience;
                const expForCurrentLevel = Math.pow(currentLevel - 1, 2) * 100;
                const expForNextLevel = Math.pow(currentLevel, 2) * 100;
                const expInCurrentLevel = currentExp - expForCurrentLevel;
                const expNeededForLevel = expForNextLevel - expForCurrentLevel;
                
                const progressPercent = (expInCurrentLevel / expNeededForLevel) * 100;
                
                document.getElementById('experience-progress').style.width = `${Math.min(100, progressPercent)}%`;
                document.getElementById('progression-text').textContent = 
                    `Level ${currentLevel} Progress: ${expInCurrentLevel.toLocaleString()} / ${expNeededForLevel.toLocaleString()}`;
            }
            
            updateLiveMetrics() {
                // Add subtle animations and updates to metrics
                const metrics = document.querySelectorAll('.metric-card');
                metrics.forEach((metric, index) => {
                    setTimeout(() => {
                        metric.style.transform = 'scale(1.02)';
                        setTimeout(() => {
                            metric.style.transform = 'scale(1)';
                        }, 150);
                    }, index * 100);
                });
            }
            
            selectTerritory(territory) {
                this.logToConsole('info', `[TERRITORY] Selected: ${territory.name}`);
                
                // Show territory details
                const details = {
                    'Gaming Empire': { files: 2341, activity: 'High', control: 95 },
                    'AI Territories': { files: 1876, activity: 'Very High', control: 88 },
                    'Business District': { files: 3421, activity: 'Medium', control: 92 },
                    'API Gateway Sector': { files: 1234, activity: 'High', control: 97 },
                    'Crypto Realms': { files: 987, activity: 'Low', control: 76 },
                    'Security Fortress': { files: 1543, activity: 'Critical', control: 99 },
                    'Creative Quarters': { files: 2105, activity: 'Medium', control: 84 },
                    'Unified Command': { files: 1366, activity: 'Very High', control: 100 }
                };
                
                const detail = details[territory.name];
                if (detail) {
                    this.logToConsole('info', `[${territory.name.toUpperCase()}] ${detail.files} files, ${detail.control}% control, ${detail.activity} activity`);
                }
            }
            
            logToConsole(type, message) {
                const console = document.getElementById('console-output');
                const line = document.createElement('div');
                line.className = `console-line ${type}`;
                line.textContent = `${new Date().toLocaleTimeString()} ${message}`;
                console.appendChild(line);
                console.scrollTop = console.scrollHeight;
                
                // Keep console manageable
                while (console.children.length > 50) {
                    console.removeChild(console.firstChild);
                }
            }
        }
        
        // Global functions for dashboard controls
        async function refreshWorldState() {
            dashboard.logToConsole('info', '[MANUAL] Refreshing world state...');
            await dashboard.updateGameWorldState();
            dashboard.logToConsole('success', '[MANUAL] World state refreshed');
        }
        
        async function triggerBackup() {
            dashboard.logToConsole('info', '[BACKUP] Creating manual backup...');
            dashboard.gameState.systemIntegrity.backupsCreated++;
            document.getElementById('backups-created').textContent = dashboard.gameState.systemIntegrity.backupsCreated;
            dashboard.logToConsole('success', '[BACKUP] Backup created successfully');
        }
        
        async function checkIntegrity() {
            dashboard.logToConsole('info', '[INTEGRITY] Performing integrity check...');
            await new Promise(resolve => setTimeout(resolve, 1000)); // Simulate check
            dashboard.logToConsole('success', '[INTEGRITY] All systems healthy - state never reset principle maintained');
        }
        
        async function exportState() {
            dashboard.logToConsole('info', '[EXPORT] Exporting game world state...');
            const stateData = JSON.stringify(dashboard.gameState, null, 2);
            const blob = new Blob([stateData], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `game-world-state-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            dashboard.logToConsole('success', '[EXPORT] Game state exported successfully');
        }
        
        // Initialize dashboard when page loads
        let dashboard;
        window.addEventListener('load', () => {
            dashboard = new LiveGameWorldDashboard();
        });
    </script>
</body>
</html>